window.__require=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){return o(t[s][1][e]||e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<r.length;s++)o(r[s]);return o}({ConnectionManager:[function(e,t,n){"use strict";cc._RF.push(t,"9cf07sV71xOMoCTgGD0Fp9b","ConnectionManager"),Object.defineProperty(n,"__esModule",{value:!0});var r=e("@aspnet/signalr"),o=e("jso"),i=function(){function e(){this.connectTryCount=0,this._player=null,this.client=new o.JSO({providerID:"snapGameOauth",client_id:"snapGameApiDevSwagger",authorization:"https://localhost:52365/connect/authorize",token:"https://localhost:52365/connect/token",redirect_uri:"http://localhost:7456",debug:!0,scopes:{request:["snapgame"]},response_type:"token",request:{nonce:"636864884858396406.MWI4ZjNkYWItOGU1My00YmFiLTg1MTAtMWQzOTY2OTM4YzRkOGFhOGI1OGItODc0YS00NGEyLWI3NzgtYzU0YmJiMzk5NWY0"}})}return e.getInstance=function(){return e.conn},Object.defineProperty(e.prototype,"player",{get:function(){return this._player},set:function(t){this._player=t;var n=this._player?e.ON_PLAYER_LOGIN_EVENT:e.ON_PLAYER_LOGOUT;this.dispatch(n,this._player)},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var e=this;return this.login().then(function(){return e.connect().catch(function(e){throw cc.error(e),e})})},e.prototype.login=function(){var t=this;return this.client.callback(),cc.log("Trying to loggin"),this.dispatch(e.ON_CHALLENGING,{}),this.client.getToken().then(function(e){t.token=e,cc.log("I got the token: ",t.token);new o.Fetcher(t.client).fetch("https://localhost:44378/api/Player/me",{}).then(function(e){return e.json()}).then(function(e){cc.log("Player ifno recieved from the server "+e),t.player=e}).catch(function(e){throw cc.error("Error getting user data: ",e),e})}).catch(function(e){throw cc.error("Error from getToken: ",e),e})},e.prototype.logout=function(){this.client.wipeTokens(),this.player=null},e.prototype.connect=function(){var t=this;if(!this.connection){var n=(new r.HubConnectionBuilder).configureLogging(r.LogLevel.Information).withUrl(e.ENPOINT,{accessTokenFactory:function(){return t.token?t.token.access_token:""}});this.connection=n.build(),this.connection.onclose(function(n){t.dispatch(e.ON_CONNECTION_CLOSED,n)})}if(this.connection.state===r.HubConnectionState.Connected)return new Promise(function(){cc.log("You are already connected")});if(cc.log("Connecting"),this.dispatch(e.ON_CONNECTING,{}),this.connectTryCount++,this.connectTryCount>10)throw"maxReconnectFailed";return this.connection.start().then(function(n){t.connectTryCount=0,t.connection.on(e.CREATE_ROOM,function(n){cc.log(e.CREATE_ROOM+" received: "+n),t.dispatch(e.ON_CREATE_ROOM,n)}),t.connection.on(e.JOIN_GAME_MESSAGE,function(n){cc.log(e.JOIN_GAME_MESSAGE+" received: "+n),t.dispatch(e.ON_JOIN_GAME_MESSAGE,n)}),t.connection.on(e.START_GAME_MESSAGE,function(n){cc.log(e.START_GAME_MESSAGE+" received: "+n),t.dispatch(e.ON_START_GAME_MESSAGE,n)}),t.connection.on(e.POP_CARD_MESSAGE,function(n){cc.log(e.POP_CARD_MESSAGE+" received: "+n),t.dispatch(e.ON_POP_CARD_MESSAGE,n)}),t.connection.on(e.SNAP_MESSAGE,function(n){cc.log(e.SNAP_MESSAGE+" received: "+n),t.dispatch(e.ON_SNAP_MESSAGE,n)}),t.dispatch(e.ON_CONNECTED,{}),cc.log("Connection stablished!")})},e.prototype.createRoom=function(){return this.validateConnected(),this.connection.send(e.CREATE_ROOM).then(function(e){cc.log(e)}).catch(function(e){throw cc.error(e),e})},e.prototype.startGame=function(t){return this.validateConnected(),this.connection.send(e.START_GAME_MESSAGE,t).then(function(t){cc.log("Message "+e.START_GAME_MESSAGE+" sent")}).catch(function(e){throw cc.error(e),e})},e.prototype.joinGame=function(t,n){return void 0===n&&(n=!1),this.validateConnected(),this.connection.send(e.JOIN_GAME_MESSAGE,t,n).then(function(t){cc.log("Message "+e.JOIN_GAME_MESSAGE+" sent")}).catch(function(e){throw cc.error(e),e})},e.prototype.popCard=function(t){return this.validateConnected(),this.connection.send(e.POP_CARD_MESSAGE,t).then(function(t){cc.log("Message "+e.POP_CARD_MESSAGE+" sent")}).catch(function(e){throw cc.error(e),e})},e.prototype.snap=function(t){return this.validateConnected(),this.connection.send(e.SNAP_MESSAGE,t).then(function(t){cc.log("Message "+e.POP_CARD_MESSAGE+" sent")}).catch(function(e){throw cc.error(e),e})},e.prototype.validateConnected=function(){if(this.connection.state===r.HubConnectionState.Disconnected)throw cc.error("You should be connected to create a room"),"You are discconected"},e.prototype.dispatch=function(e,t){var n=new cc.Event.EventCustom(e,!0);n.target=this,n.setUserData(t),cc.director.dispatchEvent(n),cc.systemEvent.dispatchEvent(n)},e.conn=new e,e.ON_CHALLENGING="onChallenging",e.ON_PLAYER_LOGIN_EVENT="onPlayerLoginEvent",e.ON_PLAYER_LOGOUT="onPlayerLogoutEvent",e.ON_CONNECTING="onConnecting",e.ON_CONNECTION_CLOSED="onConnectionClosed",e.ON_CONNECTED="onConnected",e.CREATE_ROOM="CreateRoom",e.JOIN_GAME_MESSAGE="JoinGame",e.START_GAME_MESSAGE="StartGame",e.POP_CARD_MESSAGE="PopCard",e.SNAP_MESSAGE="Snap",e.ON_CREATE_ROOM="OnCreateRoom",e.ON_POP_CARD_MESSAGE="OnJoinGame",e.ON_START_GAME_MESSAGE="OnStartGame",e.ON_JOIN_GAME_MESSAGE="OnPopCard",e.ON_SNAP_MESSAGE="OnPopCard",e.ENPOINT="https://localhost:44378/game_notifications",e}();n.ConnectionManager=i,n.default=i,cc._RF.pop()},{"@aspnet/signalr":24,jso:25}],1:[function(e,t,n){"use strict";n.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},n.toByteArray=function(e){for(var t,n=u(e),r=n[0],s=n[1],a=new i(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),c=0,l=s>0?r-4:r,f=0;f<l;f+=4)t=o[e.charCodeAt(f)]<<18|o[e.charCodeAt(f+1)]<<12|o[e.charCodeAt(f+2)]<<6|o[e.charCodeAt(f+3)],a[c++]=t>>16&255,a[c++]=t>>8&255,a[c++]=255&t;2===s&&(t=o[e.charCodeAt(f)]<<2|o[e.charCodeAt(f+1)]>>4,a[c++]=255&t);1===s&&(t=o[e.charCodeAt(f)]<<10|o[e.charCodeAt(f+1)]<<4|o[e.charCodeAt(f+2)]>>2,a[c++]=t>>8&255,a[c++]=255&t);return a},n.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(f(e,s,s+16383>a?a:s+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(r));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],2:[function(e,t,n){(function(t){"use strict";var r=e("base64-js"),o=e("ieee754"),i=e("isarray");function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|h(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|h(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var f=!0,p=0;p<c;p++)if(u(e,i+p)!==u(t,p)){f=!1;break}if(f)return i}return-1}function m(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function b(e,t,n,r){return F(U(t,e.length-n),e,n,r)}function w(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return F(B(t),e,n,r)}function E(e,t,n,r){return F(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],l=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=f}return function(e){var t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=P));return n}(r)}n.Buffer=c,n.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},n.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return O(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,s=n-t,a=Math.min(i,s),u=this.slice(r,o),l=e.slice(t,n),f=0;f<a;++f)if(u[f]!==l[f]){i=u[f],s=l[f];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return m(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function O(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function L(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=G(e[i]);return o}function M(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function x(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function j(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,i){return i||j(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,i){return i||j(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):x(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):x(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):x(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:U(new c(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function B(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:4,isarray:3}],3:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],4:[function(e,t,n){n.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,f=n?o-1:0,p=n?-1:1,h=e[t+f];for(f+=p,i=h&(1<<-l)-1,h>>=-l,l+=a;l>0;i=256*i+e[t+f],f+=p,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=p,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),i-=u}return(h?-1:1)*s*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,f=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,d=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+f>=1?p/c:p*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*c-1)*Math.pow(2,o),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;e[n+h]=255&a,h+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+h]=255&s,h+=d,s/=256,u-=8);e[n+h-d]|=128*g}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}();n.AbortController=r},{}],6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o,i=e("./Errors"),s=e("./HttpClient"),a=e("./XhrHttpClient");if("undefined"==typeof XMLHttpRequest){var c="function"==typeof __webpack_require__?__non_webpack_require__:e;o=c("./NodeHttpClient")}var u=function(e){function t(t){var n=e.call(this)||this;if("undefined"!=typeof XMLHttpRequest)n.httpClient=new a.XhrHttpClient(t);else{if(void 0===o)throw new Error("No HttpClient could be created.");n.httpClient=new o.NodeHttpClient(t)}return n}return r(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new i.AbortError):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(s.HttpClient);n.DefaultHttpClient=u},{"./Errors":7,"./HttpClient":9,"./XhrHttpClient":23}],7:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(t,n){var r=this,o=this.constructor.prototype;return(r=e.call(this,t)||this).statusCode=n,r.__proto__=o,r}return r(t,e),t}(Error);n.HttpError=o;var i=function(e){function t(t){var n=this.constructor;void 0===t&&(t="A timeout occurred.");var r=this,o=n.prototype;return(r=e.call(this,t)||this).__proto__=o,r}return r(t,e),t}(Error);n.TimeoutError=i;var s=function(e){function t(t){var n=this.constructor;void 0===t&&(t="An abort occurred.");var r=this,o=n.prototype;return(r=e.call(this,t)||this).__proto__=o,r}return r(t,e),t}(Error);n.AbortError=s},{}],8:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./TextMessageFormat"),o=e("./Utils"),i=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return r.TextMessageFormat.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var n,i;if(o.isArrayBuffer(e)||void 0!==t&&e instanceof t){var s=new Uint8Array(e);if(-1===(c=s.indexOf(r.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=c+1;n=String.fromCharCode.apply(null,s.slice(0,a)),i=s.byteLength>a?s.slice(a).buffer:null}else{var c,u=e;if(-1===(c=u.indexOf(r.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");a=c+1;n=u.substring(0,a),i=u.length>a?u.substring(a):null}var l=r.TextMessageFormat.parse(n),f=JSON.parse(l[0]);if(f.type)throw new Error("Expected a handshake response from the server.");return[i,f]},e}();n.HandshakeProtocol=i}).call(this,e("buffer").Buffer)},{"./TextMessageFormat":20,"./Utils":21,buffer:2}],9:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(n,"__esModule",{value:!0});var o=function(){return function(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}();n.HttpResponse=o;var i=function(){function e(){}return e.prototype.get=function(e,t){return this.send(r({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(r({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(r({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}();n.HttpClient=i},{}],10:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./DefaultHttpClient"),s=e("./ILogger"),a=e("./ITransport"),c=e("./LongPollingTransport"),u=e("./ServerSentEventsTransport"),l=e("./Utils"),f=e("./WebSocketTransport"),p=null,h=null;if("undefined"==typeof window&&void 0!==e){var d="function"==typeof __webpack_require__?__non_webpack_require__:e;p=d("ws"),h=d("eventsource")}var g=function(){function e(e,t){void 0===t&&(t={}),this.features={},l.Arg.isRequired(e,"url"),this.logger=l.createLogger(t.logger),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent||!1;var n="undefined"==typeof window;n||"undefined"==typeof WebSocket||t.WebSocket?n&&!t.WebSocket&&p&&(t.WebSocket=p):t.WebSocket=WebSocket,n||"undefined"==typeof EventSource||t.EventSource?n&&!t.EventSource&&void 0!==h&&(t.EventSource=h):t.EventSource=EventSource,this.httpClient=t.httpClient||new i.DefaultHttpClient(this.logger),this.connectionState=2,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return e=e||a.TransferFormat.Binary,l.Arg.isIn(e,a.TransferFormat,"transferFormat"),this.logger.log(s.LogLevel.Debug,"Starting connection with transfer format '"+a.TransferFormat[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:this.connectionState=2,this.stopError=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:t.sent(),this.transport=void 0,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return r(this,void 0,void 0,function(){var t,n,r,i,u,l,f,p=this;return o(this,function(h){switch(h.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,h.label=1;case 1:return h.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==a.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(a.HttpTransportType.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return h.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,r=0,i=function(){var e;return o(this,function(o){switch(o.label){case 0:return[4,u.getNegotiationResponse(t)];case 1:if(n=o.sent(),2===u.connectionState)return[2,{value:void 0}];if(n.error)throw Error(n.error);if(n.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(t=n.url),n.accessToken&&(e=n.accessToken,u.accessTokenFactory=function(){return e}),r++,[2]}})},u=this,h.label=6;case 6:return[5,i()];case 7:if("object"==typeof(l=h.sent()))return[2,l.value];h.label=8;case 8:if(n.url&&r<100)return[3,6];h.label=9;case 9:if(100===r&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,n,e)];case 10:h.sent(),h.label=11;case 11:return this.transport instanceof c.LongPollingTransport&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return p.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw f=h.sent(),this.logger.log(s.LogLevel.Error,"Failed to start the connection: "+f),this.connectionState=2,this.transport=void 0,f;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return r(this,void 0,void 0,function(){var t,n,r,i,a,c;return o(this,function(o){switch(o.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=o.sent())&&((t={}).Authorization="Bearer "+r,n=t),o.label=2;case 2:i=this.resolveNegotiateUrl(e),this.logger.log(s.LogLevel.Debug,"Sending negotiation request: "+i+"."),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.httpClient.post(i,{content:"",headers:n})];case 4:if(200!==(a=o.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+a.statusCode);return[2,JSON.parse(a.content)];case 5:throw c=o.sent(),this.logger.log(s.LogLevel.Error,"Failed to complete negotiation with the server: "+c),c;case 6:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,n,i){return r(this,void 0,void 0,function(){var r,c,u,l,f,p,h;return o(this,function(o){switch(o.label){case 0:return r=this.createConnectUrl(e,n.connectionId),this.isITransport(t)?(this.logger.log(s.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(r,i)]):[3,2];case 1:return o.sent(),this.changeState(0,1),[2];case 2:c=n.availableTransports||[],u=0,l=c,o.label=3;case 3:return u<l.length?(f=l[u],this.connectionState=0,"number"!=typeof(p=this.resolveTransport(f,t,i))?[3,8]:(this.transport=this.constructTransport(p),n.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:n=o.sent(),r=this.createConnectUrl(e,n.connectionId),o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.transport.connect(r,i)];case 6:return o.sent(),this.changeState(0,1),[2];case 7:return h=o.sent(),this.logger.log(s.LogLevel.Error,"Failed to start the transport '"+a.HttpTransportType[p]+"': "+h),this.connectionState=2,n.connectionId=void 0,[3,8];case 8:return u++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case a.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new f.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case a.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new u.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case a.HttpTransportType.LongPolling:return new c.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,n){var r=a.HttpTransportType[e.transport];if(null===r||void 0===r)this.logger.log(s.LogLevel.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var o=e.transferFormats.map(function(e){return a.TransferFormat[e]});if(function(e,t){return!e||0!=(t&e)}(t,r))if(o.indexOf(n)>=0){if((r!==a.HttpTransportType.WebSockets||this.options.WebSocket)&&(r!==a.HttpTransportType.ServerSentEvents||this.options.EventSource))return this.logger.log(s.LogLevel.Debug,"Selecting transport '"+a.HttpTransportType[r]+"'."),r;this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[r]+"' because it is not supported in your environment.'")}else this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[r]+"' because it does not support the requested transfer format '"+a.TransferFormat[n]+"'.");else this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[r]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){this.transport=void 0,(e=this.stopError||e)?this.logger.log(s.LogLevel.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(s.LogLevel.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e)},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(s.LogLevel.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===t?"":e.substring(t)},e}();n.HttpConnection=g},{"./DefaultHttpClient":6,"./ILogger":14,"./ITransport":15,"./LongPollingTransport":18,"./ServerSentEventsTransport":19,"./Utils":21,"./WebSocketTransport":22}],11:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i,s=e("./HandshakeProtocol"),a=e("./IHubProtocol"),c=e("./ILogger"),u=e("./Utils"),l=3e4,f=15e3;(function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected"})(i=n.HubConnectionState||(n.HubConnectionState={}));var p=function(){function e(e,t,n){var r=this;u.Arg.isRequired(e,"connection"),u.Arg.isRequired(t,"logger"),u.Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=l,this.keepAliveIntervalInMilliseconds=f,this.logger=t,this.protocol=n,this.connection=e,this.handshakeProtocol=new s.HandshakeProtocol,this.connection.onreceive=function(e){return r.processIncomingData(e)},this.connection.onclose=function(e){return r.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=i.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:a.MessageType.Ping})}return e.create=function(t,n,r){return new e(t,n,r)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),e.prototype.start=function(){return r(this,void 0,void 0,function(){var e,t,n=this;return o(this,function(r){switch(r.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(c.LogLevel.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,t=new Promise(function(e,t){n.handshakeResolver=e,n.handshakeRejecter=t}),[4,this.connection.start(this.protocol.transferFormat)];case 1:return r.sent(),this.logger.log(c.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return r.sent(),this.logger.log(c.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 3:return r.sent(),this.connectionState=i.Connected,[2]}})})},e.prototype.stop=function(){return this.logger.log(c.LogLevel.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createStreamInvocation(e,n),i=new u.Subject(function(){var e=t.createCancelInvocation(o.invocationId),n=t.protocol.writeMessage(e);return delete t.callbacks[o.invocationId],t.sendMessage(n)});this.callbacks[o.invocationId]=function(e,t){t?i.error(t):e&&(e.type===a.MessageType.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))};var s=this.protocol.writeMessage(o);return this.sendMessage(s).catch(function(e){i.error(e),delete t.callbacks[o.invocationId]}),i},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.send=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.createInvocation(e,t,!0),o=this.protocol.writeMessage(r);return this.sendMessage(o)},e.prototype.invoke=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createInvocation(e,n,!1);return new Promise(function(e,n){t.callbacks[o.invocationId]=function(t,r){r?n(r):t&&(t.type===a.MessageType.Completion?t.error?n(new Error(t.error)):e(t.result):n(new Error("Unexpected message type: "+t.type)))};var r=t.protocol.writeMessage(o);t.sendMessage(r).catch(function(e){n(e),delete t.callbacks[o.invocationId]})})},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var n=this.methods[e];if(n)if(t){var r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,n=this.protocol.parseMessages(e,this.logger);t<n.length;t++){var r=n[t];switch(r.type){case a.MessageType.Invocation:this.invokeClientMethod(r);break;case a.MessageType.StreamItem:case a.MessageType.Completion:var o=this.callbacks[r.invocationId];null!=o&&(r.type===a.MessageType.Completion&&delete this.callbacks[r.invocationId],o(r));break;case a.MessageType.Ping:break;case a.MessageType.Close:this.logger.log(c.LogLevel.Information,"Close message received from server."),this.connection.stop(r.error?new Error("Server returned an error on close: "+r.error):void 0);break;default:this.logger.log(c.LogLevel.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,n,r;try{r=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],n=t[1]}catch(e){var o="Error parsing handshake response: "+e;this.logger.log(c.LogLevel.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error){o="Server returned handshake error: "+n.error;throw this.logger.log(c.LogLevel.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o)}return this.logger.log(c.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),r},e.prototype.resetKeepAliveInterval=function(){var e=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return r(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:if(this.connectionState!==i.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},e.prototype.resetTimeoutPeriod=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,n=this.methods[e.target.toLowerCase()];if(n){if(n.forEach(function(n){return n.apply(t,e.arguments)}),e.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(c.LogLevel.Error,r),this.connection.stop(new Error(r))}}else this.logger.log(c.LogLevel.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,n=this.callbacks;this.callbacks={},this.connectionState=i.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(e),Object.keys(n).forEach(function(t){(0,n[t])(null,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach(function(n){return n.apply(t,[e])})},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,n){if(n)return{arguments:t,target:e,type:a.MessageType.Invocation};var r=this.id;return this.id++,{arguments:t,invocationId:r.toString(),target:e,type:a.MessageType.Invocation}},e.prototype.createStreamInvocation=function(e,t){var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:a.MessageType.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:a.MessageType.CancelInvocation}},e}();n.HubConnection=p},{"./HandshakeProtocol":8,"./IHubProtocol":13,"./ILogger":14,"./Utils":21}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./HttpConnection"),o=e("./HubConnection"),i=e("./JsonHubProtocol"),s=e("./Loggers"),a=e("./Utils"),c=function(){function e(){}return e.prototype.configureLogging=function(e){return a.Arg.isRequired(e,"logging"),!function(e){return void 0!==e.log}(e)?this.logger=new a.ConsoleLogger(e):this.logger=e,this},e.prototype.withUrl=function(e,t){return a.Arg.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return a.Arg.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new r.HttpConnection(this.url,e);return o.HubConnection.create(t,this.logger||s.NullLogger.instance,this.protocol||new i.JsonHubProtocol)},e}();n.HubConnectionBuilder=c},{"./HttpConnection":10,"./HubConnection":11,"./JsonHubProtocol":16,"./Loggers":17,"./Utils":21}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(n.MessageType||(n.MessageType={}))},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(n.LogLevel||(n.LogLevel={}))},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(n.HttpTransportType||(n.HttpTransportType={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(n.TransferFormat||(n.TransferFormat={}))},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./IHubProtocol"),o=e("./ILogger"),i=e("./ITransport"),s=e("./Loggers"),a=e("./TextMessageFormat"),c="json",u=function(){function e(){this.name=c,this.version=1,this.transferFormat=i.TransferFormat.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=s.NullLogger.instance);for(var n=[],i=0,c=a.TextMessageFormat.parse(e);i<c.length;i++){var u=c[i],l=JSON.parse(u);if("number"!=typeof l.type)throw new Error("Invalid payload.");switch(l.type){case r.MessageType.Invocation:this.isInvocationMessage(l);break;case r.MessageType.StreamItem:this.isStreamItemMessage(l);break;case r.MessageType.Completion:this.isCompletionMessage(l);break;case r.MessageType.Ping:case r.MessageType.Close:break;default:t.log(o.LogLevel.Information,"Unknown message type '"+l.type+"' ignored.");continue}n.push(l)}return n},e.prototype.writeMessage=function(e){return a.TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}();n.JsonHubProtocol=u},{"./IHubProtocol":13,"./ILogger":14,"./ITransport":15,"./Loggers":17,"./TextMessageFormat":20}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}();n.NullLogger=r},{}],18:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./AbortController"),s=e("./Errors"),a=e("./ILogger"),c=e("./ITransport"),u=e("./Utils"),l=function(){function e(e,t,n,r){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.pollAbort=new i.AbortController,this.logMessageContent=r,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return r(this,void 0,void 0,function(){var n,r,i,l;return o(this,function(o){switch(o.label){case 0:if(u.Arg.isRequired(e,"url"),u.Arg.isRequired(t,"transferFormat"),u.Arg.isIn(t,c.TransferFormat,"transferFormat"),this.url=e,this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Connecting."),t===c.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},t===c.TransferFormat.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return r=o.sent(),this.updateHeaderToken(n,r),i=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+i+"."),[4,this.httpClient.get(i,n)];case 2:return 200!==(l=o.sent()).statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+l.statusCode+"."),this.closeError=new s.HttpError(l.statusText||"",l.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}})})},e.prototype.getAccessToken=function(){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}})})},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return r(this,void 0,void 0,function(){var n,r,i,c;return o(this,function(o){switch(o.label){case 0:o.trys.push([0,,8,9]),o.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=o.sent(),this.updateHeaderToken(t,n),o.label=3;case 3:return o.trys.push([3,5,,6]),r=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,t)];case 4:return 204===(i=o.sent()).statusCode?(this.logger.log(a.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==i.statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode+"."),this.closeError=new s.HttpError(i.statusText||"",i.statusCode),this.running=!1):i.content?(this.logger.log(a.LogLevel.Trace,"(LongPolling transport) data received. "+u.getDataDetail(i.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(i.content)):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return c=o.sent(),this.running?c instanceof s.TimeoutError?this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=c,this.running=!1):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+c.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},e.prototype.send=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){return this.running?[2,u.sendMessage(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return r(this,void 0,void 0,function(){var e,t;return o(this,function(n){switch(n.label){case 0:this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return t=n.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 4:return n.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(a.LogLevel.Trace,e),this.onclose(this.closeError)}},e}();n.LongPollingTransport=l},{"./AbortController":5,"./Errors":7,"./ILogger":14,"./ITransport":15,"./Utils":21}],19:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./ITransport"),a=e("./Utils"),c=function(){function e(e,t,n,r,o){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return r(this,void 0,void 0,function(){var n,r=this;return o(this,function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,s.TransferFormat,"transferFormat"),this.logger.log(i.LogLevel.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var c=!1;if(t===s.TransferFormat.Text){var u;if("undefined"!=typeof window)u=new r.eventSourceConstructor(e,{withCredentials:!0});else{var l=r.httpClient.getCookieString(e);u=new r.eventSourceConstructor(e,{withCredentials:!0,headers:{Cookie:l}})}try{u.onmessage=function(e){if(r.onreceive)try{r.logger.log(i.LogLevel.Trace,"(SSE transport) data received. "+a.getDataDetail(e.data,r.logMessageContent)+"."),r.onreceive(e.data)}catch(e){return void r.close(e)}},u.onerror=function(e){var t=new Error(e.data||"Error occurred");c?r.close(t):o(t)},u.onopen=function(){r.logger.log(i.LogLevel.Information,"SSE connected to "+r.url),r.eventSource=u,c=!0,n()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},e.prototype.send=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){return this.eventSource?[2,a.sendMessage(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}();n.ServerSentEventsTransport=c},{"./ILogger":14,"./ITransport":15,"./Utils":21}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var n=t.split(e.RecordSeparator);return n.pop(),n},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}();n.TextMessageFormat=r},{}],21:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./Loggers"),a=function(){function e(){}return e.isRequired=function(e,t){if(null===e||void 0===e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,n){if(!(e in t))throw new Error("Unknown "+n+" value: "+e+".")},e}();function c(e,t){var n="";return l(e)?(n="Binary data of length "+e.byteLength,t&&(n+=". Content: '"+u(e)+"'")):"string"==typeof e&&(n="String data of length "+e.length,t&&(n+=". Content: '"+e+"'")),n}function u(e){var t="";return new Uint8Array(e).forEach(function(e){t+="0x"+(e<16?"0":"")+e.toString(16)+" "}),t.substr(0,t.length-1)}function l(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}n.Arg=a,n.getDataDetail=c,n.formatArrayBuffer=u,n.isArrayBuffer=l,n.sendMessage=function(e,t,n,s,a,u,f){return r(this,void 0,void 0,function(){var r,p,h,d,g;return o(this,function(o){switch(o.label){case 0:return a?[4,a()]:[3,2];case 1:(h=o.sent())&&((r={}).Authorization="Bearer "+h,p=r),o.label=2;case 2:return e.log(i.LogLevel.Trace,"("+t+" transport) sending data. "+c(u,f)+"."),d=l(u)?"arraybuffer":"text",[4,n.post(s,{content:u,headers:p,responseType:d})];case 3:return g=o.sent(),e.log(i.LogLevel.Trace,"("+t+" transport) request complete. Response status: "+g.statusCode+"."),[2]}})})},n.createLogger=function(e){return void 0===e?new h(i.LogLevel.Information):null===e?s.NullLogger.instance:e.log?e:new h(e)};var f=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,n=this.observers;t<n.length;t++){n[t].next(e)}},e.prototype.error=function(e){for(var t=0,n=this.observers;t<n.length;t++){var r=n[t];r.error&&r.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var n=t[e];n.complete&&n.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new p(this,e)},e}();n.Subject=f;var p=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}();n.SubjectSubscription=p;var h=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case i.LogLevel.Critical:case i.LogLevel.Error:console.error("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;case i.LogLevel.Warning:console.warn("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;case i.LogLevel.Information:console.info("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;default:console.log("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t)}},e}();n.ConsoleLogger=h},{"./ILogger":14,"./Loggers":17}],22:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./ITransport"),a=e("./Utils"),c=function(){function e(e,t,n,r,o){this.logger=n,this.accessTokenFactory=t,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=e,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return r(this,void 0,void 0,function(){var n,r=this;return o(this,function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,s.TransferFormat,"transferFormat"),this.logger.log(i.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var c;e=e.replace(/^http/,"ws");var u=r.httpClient.getCookieString(e);"undefined"==typeof window&&u&&(c=new r.webSocketConstructor(e,void 0,{headers:{Cookie:""+u}})),c||(c=new r.webSocketConstructor(e)),t===s.TransferFormat.Binary&&(c.binaryType="arraybuffer"),c.onopen=function(t){r.logger.log(i.LogLevel.Information,"WebSocket connected to "+e+"."),r.webSocket=c,n()},c.onerror=function(e){var t=null;"undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent&&(t=e.error),o(t)},c.onmessage=function(e){r.logger.log(i.LogLevel.Trace,"(WebSockets transport) data received. "+a.getDataDetail(e.data,r.logMessageContent)+"."),r.onreceive&&r.onreceive(e.data)},c.onclose=function(e){return r.close(e)}})]}})})},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(i.LogLevel.Trace,"(WebSockets transport) sending data. "+a.getDataDetail(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},e.prototype.close=function(e){this.logger.log(i.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!e||!1!==e.wasClean&&1e3===e.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e}();n.WebSocketTransport=c},{"./ILogger":14,"./ITransport":15,"./Utils":21}],23:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Errors"),i=e("./HttpClient"),s=e("./ILogger"),a=function(e){function t(t){var n=e.call(this)||this;return n.logger=t,n}return r(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new o.AbortError):e.method?e.url?new Promise(function(n,r){var a=new XMLHttpRequest;a.open(e.method,e.url,!0),a.withCredentials=!0,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var c=e.headers;c&&Object.keys(c).forEach(function(e){a.setRequestHeader(e,c[e])}),e.responseType&&(a.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){a.abort(),r(new o.AbortError)}),e.timeout&&(a.timeout=e.timeout),a.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),a.status>=200&&a.status<300?n(new i.HttpResponse(a.status,a.statusText,a.response||a.responseText)):r(new o.HttpError(a.statusText,a.status))},a.onerror=function(){t.logger.log(s.LogLevel.Warning,"Error from HTTP request. "+a.status+": "+a.statusText+"."),r(new o.HttpError(a.statusText,a.status))},a.ontimeout=function(){t.logger.log(s.LogLevel.Warning,"Timeout from HTTP request."),r(new o.TimeoutError)},a.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(i.HttpClient);n.XhrHttpClient=a},{"./Errors":7,"./HttpClient":9,"./ILogger":14}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.VERSION="1.1.2";var r=e("./Errors");n.AbortError=r.AbortError,n.HttpError=r.HttpError,n.TimeoutError=r.TimeoutError;var o=e("./HttpClient");n.HttpClient=o.HttpClient,n.HttpResponse=o.HttpResponse;var i=e("./DefaultHttpClient");n.DefaultHttpClient=i.DefaultHttpClient;var s=e("./HubConnection");n.HubConnection=s.HubConnection,n.HubConnectionState=s.HubConnectionState;var a=e("./HubConnectionBuilder");n.HubConnectionBuilder=a.HubConnectionBuilder;var c=e("./IHubProtocol");n.MessageType=c.MessageType;var u=e("./ILogger");n.LogLevel=u.LogLevel;var l=e("./ITransport");n.HttpTransportType=l.HttpTransportType,n.TransferFormat=l.TransferFormat;var f=e("./Loggers");n.NullLogger=f.NullLogger;var p=e("./JsonHubProtocol");n.JsonHubProtocol=p.JsonHubProtocol},{"./DefaultHttpClient":6,"./Errors":7,"./HttpClient":9,"./HubConnection":11,"./HubConnectionBuilder":12,"./IHubProtocol":13,"./ILogger":14,"./ITransport":15,"./JsonHubProtocol":16,"./Loggers":17}],25:[function(e,t,n){!function(e,r){"object"==typeof n&&"object"==typeof t?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof n?n.jso=r():e.jso=r()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}([function(e,t,n){var r=n(40)("wks"),o=n(25),i=n(1).Symbol,s="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(10);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(16),o=n(44);e.exports=n(9)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(1),o=n(2),i=n(4),s=n(8),a=n(15),c=function(e,t,n){var u,l,f,p,h=e&c.F,d=e&c.G,g=e&c.S,v=e&c.P,y=e&c.B,m=d?r:g?r[t]||(r[t]={}):(r[t]||{}).prototype,b=d?o:o[t]||(o[t]={}),w=b.prototype||(b.prototype={});for(u in d&&(n=t),n)f=((l=!h&&m&&void 0!==m[u])?m:n)[u],p=y&&l?a(f,r):v&&"function"==typeof f?a(Function.call,f):f,m&&s(m,u,f,e&c.U),b[u]!=f&&i(b,u,p),v&&w[u]!=f&&(w[u]=f)};r.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){e.exports={}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(1),o=n(4),i=n(7),s=n(25)("src"),a=Function.toString,c=(""+a).split("toString");n(2).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var u="function"==typeof n;u&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(u&&(i(n,s)||o(n,s,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,n){e.exports=!n(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log("Initializing a loader with url "+t),this.url=t}return r(e,[{key:"execute",value:function(){}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={epoch:function(){return Math.round((new Date).getTime()/1e3)},debug:!1,uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getResponseFromURL:function(e){return-1!==e.indexOf("#")?r.parseQueryString(e.substring(e.indexOf("#")+1)):-1!==e.indexOf("?")?r.parseQueryString(e.substring(e.indexOf("?")+1)):{}},parseQueryString:function(e){for(var t,n=/\+/g,r=/([^&;=]+)=?([^&;]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i=e,s={};t=r.exec(i);)s[o(t[1])]=o(t[2]);return s},scopeList:function(e){return r.uniqueList(e).join(" ")},uniqueList:function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]=1;for(var o in t)t.hasOwnProperty(o)&&n.push(o);return n},log:function(e){if(console&&console.log&&r.debug){var t=Array.prototype.slice.call(arguments);t.unshift("[JSO]"),console.log.apply(console,t)}},encodeQS:function(e){var t,n="",r=0;for(t in e)n+=(0==r++?"":"&")+encodeURIComponent(t)+"="+encodeURIComponent(e[t]);return n},encodeURL:function(e,t){var n,r=e,o=0,i=-1===e.indexOf("?")?"?":"&";for(n in t)r+=(0==o++?i:"&")+encodeURIComponent(n)+"="+encodeURIComponent(t[n]);return r}};t.default=r},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(14);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(3),o=n(87),i=n(86),s=Object.defineProperty;t.f=n(9)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var r=n(14);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(16).f,o=n(7),i=n(0)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(13),o=n(0)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(40)("keys"),o=n(25);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(43),o=n(22);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(84),o=n(39);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(10),o=n(1).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[n]=t[n]}return r(e,[{key:"set",value:function(e,t){return this[e]=t,this}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=(r=n(28))&&r.__esModule?r:{default:r},i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();t.default=i},function(e,t,n){var r=n(3),o=n(10),i=n(17);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r,o,i,s=n(15),a=n(61),c=n(34),u=n(26),l=n(1),f=l.process,p=l.setImmediate,h=l.clearImmediate,d=l.MessageChannel,g=l.Dispatch,v=0,y={},m=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},b=function(e){m.call(e.data)};p&&h||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return y[++v]=function(){a("function"==typeof e?e:Function(e),t)},r(v),v},h=function(e){delete y[e]},"process"==n(13)(f)?r=function(e){f.nextTick(s(m,e,1))}:g&&g.now?r=function(e){g.now(s(m,e,1))}:d?(i=(o=new d).port2,o.port1.onmessage=b,r=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),m.call(e)}}:function(e){setTimeout(s(m,e,1),0)}),e.exports={set:p,clear:h}},function(e,t,n){var r=n(3),o=n(14),i=n(0)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[i])?t:o(n)}},function(e,t,n){var r=n(1).document;e.exports=r&&r.documentElement},function(e,t){e.exports=!1},function(e,t,n){"use strict";var r=n(35),o=n(5),i=n(8),s=n(4),a=n(7),c=n(6),u=n(74),l=n(18),f=n(71),p=n(0)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,g,v,y,m){u(n,t,g);var b,w,_,S=function(e){if(!h&&e in P)return P[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},E=t+" Iterator",T="values"==v,C=!1,P=e.prototype,O=P[p]||P["@@iterator"]||v&&P[v],k=!h&&O||S(v),L=v?T?S("entries"):k:void 0,M="Array"==t&&P.entries||O;if(M&&(_=f(M.call(new e)))!==Object.prototype&&_.next&&(l(_,E,!0),r||a(_,p)||s(_,p,d)),T&&O&&"values"!==O.name&&(C=!0,k=function(){return O.call(this)}),r&&!m||!h&&!C&&P[p]||s(P,p,k),c[t]=k,c[E]=d,v)if(b={values:T?k:S("values"),keys:y?k:S("keys"),entries:L},m)for(w in b)w in P||i(P,w,b[w]);else o(o.P+o.F*(h||C),t,b);return b}},function(e,t,n){var r=n(0)("unscopables"),o=Array.prototype;void 0==o[r]&&n(4)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){var r=n(22);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(1),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t,n){var r=n(21),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(23),o=n(41),i=n(83);e.exports=function(e){return function(t,n,s){var a,c=r(t),u=o(c.length),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(13);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e){e.exports={name:"jso",version:"4.1.1",description:"OAuth 2.0 implementation in Javascript",main:"dist/jso.js",module:"src/JSO.js",scripts:{test:"true",preversion:"npm test",version:"npm run build && git add -A dist",postversion:"git push && git push --tags && npm publish",build:"webpack --mode production --config webpack.config.js"},babel:{presets:["env"]},repository:{type:"git",url:"https://github.com/andreassolberg/jso.git"},keywords:["oauth","authentication","authorization","rest","api","ajax","jquery"],files:["src"],eslintConfig:{env:{es6:!0,browser:!0,node:!1}},devDependencies:{"babel-core":"^6.26.0","babel-loader":"^7.1.4","babel-preset-env":"^1.6.1","babel-preset-react":"^6.24.1",qunit:"^2.5.1",webpack:"^4.1.1","webpack-cli":"^2.0.12"},author:"Andreas \xc5kre Solberg",license:"LGPL-2.1",bugs:{url:"https://github.com/andreassolberg/jso/issues"},homepage:"https://github.com/andreassolberg/jso",dependencies:{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"on",value:function(e,t){this._callbacks||(this._callbacks={}),this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t)}},{key:"emit",value:function(e){this._callbacks||(this._callbacks={}),this._callbacks[e]||(this._callbacks[e]=[]);for(var t=Array.prototype.slice.call(arguments,1),n=0;n<this._callbacks[e].length;n++)this._callbacks[e][n].apply(this,t)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={};for(var t=0;t<arguments.length;t++)Object.assign(this.config,arguments[t])}return r(e,[{key:"has",value:function(e){var t=this.config,n=e.split("."),r=0;for(r=0;r<n.length;r++){if(!t.hasOwnProperty(n[r]))return!1;t=t[n[r]]}return!0}},{key:"getValue",value:function(e,t,n){n=n||!1;var r=this.config,o=e.split("."),i=0;for(i=0;i<o.length;i++){if(!r.hasOwnProperty(o[i])){r=void 0;break}r=r[o[i]]}if(void 0===r){if(n)throw new Error("Configuration option ["+o[i]+"] required but not provided.");return t}return r}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(28))&&r.__esModule?r:{default:r},s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"toString",value:function(){return"OAuthResponseError: ["+(this.error||"unknown")+"]: "+(this.error_description||"unknown")}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(29))&&r.__esModule?r:{default:r},s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jso=t,this.jquery=n}return o(e,[{key:"_fetch",value:function(e,t){var n=this;return new Promise(function(r,o){return t.done=r,t.fail=function(e,t,r){return 401===parseInt(t,10)?(n.jso.wipeTokens(),o(new i.default)):o(r)},n.jquery.ajax(e,t)})}},{key:"fetch",value:function(e,t,n){var r=this;if((n=n||0)>2)throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var o={},s={mode:"cors"};return t&&(s=t,Object.assign(s,t)),t&&t.jso&&Object.assign(o,t.jso),this.jso.getToken(o).catch(function(e){console.error("Error fetching token to use ",e)}).then(function(o){return s.headers||(s.headers={}),s.headers.Authorization="Bearer "+o.access_token,r._fetch(e,s).catch(function(o){if(o instanceof i.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",o),r.jso.wipeTokens(),r.fetch(e,t,n+1)})})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(29))&&r.__esModule?r:{default:r},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jso=t}return o(e,[{key:"_fetch",value:function(e,t){return fetch(e,t).then(function(e){if(401===e.status)throw new i.default;return e})}},{key:"fetch",value:function(e,t,n){var r=this;if((n=n||0)>2)throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var o={},s={mode:"cors"};return t&&(s=t,Object.assign(s,t)),t&&t.jso&&Object.assign(o,t.jso),this.jso.getToken(o).catch(function(e){console.error("Error fetching token to use ",e)}).then(function(o){return s.headers||(s.headers={}),s.headers.Authorization="Bearer "+o.access_token,r._fetch(e,s).catch(function(o){if(o instanceof i.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",o),r.jso.wipeTokens(),r.fetch(e,t,n+1)})})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(11))&&r.__esModule?r:{default:r},s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,n){window.popupCompleted=function(){var e=r.location.href;t(e)};var r=window.open(e.url,"jso-popup-auth","height=600,width=800");if(null===r)throw new Error("Error loading popup window");window.focus&&r.focus()})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(11)),i=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.timeout=5e3,n.callback=null,n.isCompleted=!1,n.id="jso_passive_iframe_"+i.default.uuid();var r=window.addEventListener?"addEventListener":"attachEvent";return window[r],n.iframe=document.createElement("iframe"),n.iframe.setAttribute("id",n.id),n.iframe.setAttribute("src",e),n.iframe.addEventListener("load",function(e){var t=null;try{if(n.iframe.contentWindow.location.hash){var r=n.iframe.contentWindow.location.hash.substring(1);t=i.default.parseQueryString(r)}else if(n.iframe.contentWindow.location.search){var o=n.iframe.contentWindow.location.search.substring(1);t=i.default.parseQueryString(o)}null!==t?n._completed(t):n._failed(new Error("Failed to obtain response value from iframe"))}catch(e){}}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,n){e.callback=t,e.errorCallback=n,document.getElementsByTagName("body")[0].appendChild(e.iframe),setTimeout(function(){e._failed(new Error("Loading iframe timed out"))},e.timeout)})}},{key:"_cleanup",value:function(){var e=document.getElementById(this.id);e.parentNode.removeChild(e)}},{key:"_failed",value:function(e){this.isCompleted||(this.errorCallback&&"function"==typeof this.errorCallback&&this.errorCallback(e),this.isCompleted=!0,this._cleanup())}},{key:"_completed",value:function(e){this.isCompleted||(this.callback&&"function"==typeof this.callback&&this.callback(e),this.isCompleted=!0,this._cleanup())}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=i(n(11));function i(e){return e&&e.__esModule?e:{default:e}}i(n(12));var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,n){window.location=e.url})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(r=n(12))&&r.__esModule?r:{default:r},s=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"saveState",value:function(e,t){localStorage.setItem("state-"+e,JSON.stringify(t))}},{key:"getState",value:function(e){var t=JSON.parse(localStorage.getItem("state-"+e));return localStorage.removeItem("state-"+e),t}},{key:"hasScope",value:function(e,t){var n;if(!e.scopes)return!1;for(n=0;n<e.scopes.length;n++)if(e.scopes[n]===t)return!0;return!1}},{key:"filterTokens",value:function(e,t){var n,r,o,s=[],a=i.default.epoch();for(t||(t=[]),n=0;n<e.length;n++){for(o=!0,e[n].expires&&e[n].expires<a+1&&(o=!1),r=0;r<t.length;r++)this.hasScope(e[n],t[r])||(o=!1);o&&s.push(e[n])}return s}},{key:"saveTokens",value:function(e,t){localStorage.setItem("tokens-"+e,JSON.stringify(t))}},{key:"getTokens",value:function(e){var t=JSON.parse(localStorage.getItem("tokens-"+e));return t||(t=[]),i.default.log("Token found when loooking up provider "+e+" in store "+window.location.href,t),t}},{key:"wipeTokens",value:function(e){localStorage.removeItem("tokens-"+e)}},{key:"saveToken",value:function(e,t){var n=this.getTokens(e);(n=this.filterTokens(n)).push(t),this.saveTokens(e,n)}},{key:"getToken",value:function(e,t){var n=this.getTokens(e);return(n=this.filterTokens(n,t)).length<1?null:n[0]}}]),e}());t.default=s},function(e,t,n){"use strict";var r=n(5),o=n(17),i=n(31);r(r.S,"Promise",{try:function(e){var t=o.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";var r=n(5),o=n(2),i=n(1),s=n(33),a=n(30);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,o.Promise||i.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then(function(){return n})}:e,n?function(n){return a(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){var r=n(0)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],s=i[r]();s.next=function(){return{done:n=!0}},i[r]=function(){return s},e(i)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(1),o=n(16),i=n(9),s=n(0)("species");e.exports=function(e){var t=r[e];i&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(8);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){var r=n(1),o=n(32).set,i=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,c="process"==n(13)(s);e.exports=function(){var e,t,n,u=function(){var r,o;for(c&&(r=s.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){s.nextTick(u)};else if(!i||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var l=a.resolve();n=function(){l.then(u)}}else n=function(){o.call(r,u)};else{var f=!0,p=document.createTextNode("");new i(u).observe(p,{characterData:!0}),n=function(){p.data=f=!f}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(19),o=n(0)("iterator"),i=n(6);e.exports=n(2).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(6),o=n(0)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(3);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(15),o=n(64),i=n(63),s=n(3),a=n(41),c=n(62),u={},l={};(t=e.exports=function(e,t,n,f,p){var h,d,g,v,y=p?function(){return e}:c(e),m=r(n,f,t?2:1),b=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(i(y)){for(h=a(e.length);h>b;b++)if((v=t?m(s(d=e[b])[0],d[1]):m(e[b]))===u||v===l)return v}else for(g=y.call(e);!(d=g.next()).done;)if((v=o(g,m,d.value,t))===u||v===l)return v}).BREAK=u,t.RETURN=l},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var r,o,i,s,a=n(35),c=n(1),u=n(15),l=n(19),f=n(5),p=n(10),h=n(14),d=n(66),g=n(65),v=n(33),y=n(32).set,m=n(60)(),b=n(17),w=n(31),_=n(30),S=c.TypeError,E=c.process,T=c.Promise,C="process"==l(E),P=function(){},O=o=b.f,k=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(0)("species")]=function(e){e(P,P)};return(C||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t}catch(e){}}(),L=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;m(function(){for(var r=e._v,o=1==e._s,i=0,s=function(t){var n,i,s=o?t.ok:t.fail,a=t.resolve,c=t.reject,u=t.domain;try{s?(o||(2==e._h&&R(e),e._h=1),!0===s?n=r:(u&&u.enter(),n=s(r),u&&u.exit()),n===t.promise?c(S("Promise-chain cycle")):(i=L(n))?i.call(n,a,c):a(n)):c(r)}catch(e){c(e)}};n.length>i;)s(n[i++]);e._c=[],e._n=!1,t&&!e._h&&A(e)})}},A=function(e){y.call(c,function(){var t,n,r,o=e._v,i=I(e);if(i&&(t=w(function(){C?E.emit("unhandledRejection",o,e):(n=c.onunhandledrejection)?n({promise:e,reason:o}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=C||I(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},I=function(e){return 1!==e._h&&0===(e._a||e._c).length},R=function(e){y.call(c,function(){var t;C?E.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},x=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},j=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw S("Promise can't be resolved itself");(t=L(e))?m(function(){var r={_w:n,_d:!1};try{t.call(e,u(j,r,1),u(x,r,1))}catch(e){x.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){x.call({_w:n,_d:!1},e)}}};k||(T=function(e){d(this,T,"Promise","_h"),h(e),r.call(this);try{e(u(j,this,1),u(x,this,1))}catch(e){x.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(59)(T.prototype,{then:function(e,t){var n=O(v(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=C?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=u(j,e,1),this.reject=u(x,e,1)},b.f=O=function(e){return e===T||e===s?new i(e):o(e)}),f(f.G+f.W+f.F*!k,{Promise:T}),n(18)(T,"Promise"),n(58)("Promise"),s=n(2).Promise,f(f.S+f.F*!k,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(a||!k),"Promise",{resolve:function(e){return _(a&&this===s?T:this,e)}}),f(f.S+f.F*!(k&&n(57)(function(e){T.all(e).catch(P)})),"Promise",{all:function(e){var t=this,n=O(t),r=n.resolve,o=n.reject,i=w(function(){var n=[],i=0,s=1;g(e,!1,function(e){var a=i++,c=!1;n.push(void 0),s++,t.resolve(e).then(function(e){c||(c=!0,n[a]=e,--s||r(n))},o)}),--s||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=O(t),r=n.reject,o=w(function(){g(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(37),o=n(68),i=n(6),s=n(23);e.exports=n(36)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t,n){for(var r=n(69),o=n(24),i=n(8),s=n(1),a=n(4),c=n(6),u=n(0),l=u("iterator"),f=u("toStringTag"),p=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=o(h),g=0;g<d.length;g++){var v,y=d[g],m=h[y],b=s[y],w=b&&b.prototype;if(w&&(w[l]||a(w,l,p),w[f]||a(w,f,y),c[y]=p,m))for(v in r)w[v]||i(w,v,r[v],!0)}},function(e,t,n){var r=n(7),o=n(38),i=n(20)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){var r=n(16),o=n(3),i=n(24);e.exports=n(9)?Object.defineProperties:function(e,t){o(e);for(var n,s=i(t),a=s.length,c=0;a>c;)r.f(e,n=s[c++],t[n]);return e}},function(e,t,n){var r=n(3),o=n(72),i=n(39),s=n(20)("IE_PROTO"),a=function(){},c=function(){var e,t=n(26)("iframe"),r=i.length;for(t.style.display="none",n(34).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[i[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=c(),void 0===t?n:o(n,t)}},function(e,t,n){"use strict";var r=n(73),o=n(44),i=n(18),s={};n(4)(s,n(0)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(s,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(21),o=n(22);e.exports=function(e){return function(t,n){var i,s,a=String(o(t)),c=r(n),u=a.length;return c<0||c>=u?e?"":void 0:(i=a.charCodeAt(c))<55296||i>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):i:e?a.slice(c,c+2):s-56320+(i-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(75)(!0);n(36)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(19),o={};o[n(0)("toStringTag")]="z",o+""!="[object z]"&&n(8)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){n(77),n(76),n(70),n(67),n(56),n(55),e.exports=n(2).Promise},function(e,t,n){"use strict";var r=n(5),o=n(42)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(37)("includes")},function(e,t,n){n(79),e.exports=n(2).Array.includes},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(21),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(7),o=n(23),i=n(42)(!1),s=n(20)("IE_PROTO");e.exports=function(e,t){var n,a=o(e),c=0,u=[];for(n in a)n!=s&&r(a,n)&&u.push(n);for(;t.length>c;)r(a,n=t[c++])&&(~i(u,n)||u.push(n));return u}},function(e,t,n){"use strict";var r=n(24),o=n(82),i=n(81),s=n(38),a=n(43),c=Object.assign;e.exports=!c||n(27)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=r})?function(e,t){for(var n=s(e),c=arguments.length,u=1,l=o.f,f=i.f;c>u;)for(var p,h=a(arguments[u++]),d=l?r(h).concat(l(h)):r(h),g=d.length,v=0;g>v;)f.call(h,p=d[v++])&&(n[p]=h[p]);return n}:c},function(e,t,n){var r=n(10);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports=!n(9)&&!n(27)(function(){return 7!=Object.defineProperty(n(26)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(5);r(r.S+r.F,"Object",{assign:n(85)})},function(e,t,n){n(88),e.exports=n(2).Object.assign},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetcherJQuery=t.Fetcher=t.IFramePassive=t.Popup=t.HTTPRedirect=t.BasicLoader=t.JSO=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(89));n(80),n(78);var s=y(n(54)),a=y(n(12)),c=y(n(11)),u=y(n(53)),l=y(n(52)),f=y(n(51)),p=y(n(50)),h=y(n(49)),d=y(n(48)),g=y(n(47)),v=y(n(46));function y(e){return e&&e.__esModule?e:{default:e}}n(45);var m={lifetime:3600},b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.configure(e),n.providerID=n.getProviderID(),n.Loader=u.default,n.store=s.default,n.callbacks={},n.config.getValue("debug",!1)&&(a.default.debug=!0),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.default),o(t,[{key:"configure",value:function(e){this.config=new g.default(m,e)}},{key:"setStore",value:function(e){this.store=e}},{key:"setLoader",value:function(e){if("function"!=typeof e)throw new Error("loader MUST be an instance of the JSO BasicLoader");this.Loader=e}},{key:"getProviderID",value:function(){var e=this.config.getValue("providerID",null);if(null!==e)return e;var t=this.config.getValue("client_id",null,!0);return this.config.getValue("authorization",null,!0)+"|"+t}},{key:"processTokenResponse",value:function(e){var t;if(!e.state)throw new Error("Could not get state from storage.");if(!(t=this.store.getState(e.state)))throw new Error("Could not retrieve state");if(!t.providerID)throw new Error("Could not get providerid from state");return a.default.log("processTokenResponse ",e,""),this.processReceivedToken(e,t)}},{key:"processReceivedToken",value:function(e,t){var n=a.default.epoch();return e.received=n,e.expires_in?(e.expires=n+parseInt(e.expires_in,10),e.expires_in=parseInt(e.expires_in,10)):!1===this.config.getValue("default_lifetime",null)?e.expires=null:this.config.has("permanent_scope")?this.store.hasScope(e,this.config.getValue("permanent_scope"))||(e.expires=null):this.config.has("default_lifetime")?e.expires=n+this.config.getValue("default_lifetime"):e.expires=n+3600,e.scope?(e.scopes=e.scope.split(" "),delete e.scope):t.scopes?e.scopes=t.scopes:e.scopes=[],a.default.log("processTokenResponse completed ",e,""),this.store.saveToken(t.providerID,e),t.restoreHash?window.location.hash=t.restoreHash:window.location.hash="",e}},{key:"processAuthorizationCodeResponse",value:function(e){var t=this;console.log(this),this.emit("authorizationCode",e);var n=void 0;if(!e.state)throw new Error("Could not find state paramter from callback.");if(null===(n=this.store.getState(e.state)))throw new Error("Could not find retrieve state object.");if(console.log("state",n),this.config.has("token")){if(!this.config.has("client_secret"))throw new Error("Configuration missing [client_secret]");var r=new Headers;r.append("Authorization","Basic "+btoa(this.config.getValue("client_id")+":"+this.config.getValue("client_secret"))),r.append("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");var o={grant_type:"authorization_code",code:e.code};n.hasOwnProperty("redirect_uri")&&(o.redirect_uri=n.redirect_uri);var i={mode:"cors",headers:r,method:"POST",body:a.default.encodeQS(o)};return fetch(this.config.getValue("token"),i).then(function(e){return e.json()}).then(function(e){return a.default.log("Received response on token endpoint ",e,""),t.processReceivedToken(e,n)})}a.default.log("Received an authorization code. Will not process it as the config option [token] endpoint is not set. If you would like to process the code yourself, please subscribe to the [authorizationCode] event")}},{key:"processErrorResponse",value:function(e){var t;if(!e.state)throw new Error("Could not get [state] and no default providerid is provided.");if(!(t=this.store.getState(e.state)))throw new Error("Could not retrieve state");if(!t.providerID)throw new Error("Could not get providerid from state");return t.restoreHash?window.location.hash=t.restoreHash:window.location.hash="",new d.default(e)}},{key:"callback",value:function(e){var t=null;if("object"===(void 0===e?"undefined":r(e)))t=e;else if("string"==typeof e)t=a.default.getResponseFromURL(e);else{if(void 0!==e)return;t=a.default.getResponseFromURL(window.location.href)}if(a.default.log("Receving response in callback",t),t.hasOwnProperty("access_token"))return this.processTokenResponse(t);if(t.hasOwnProperty("code"))return this.processAuthorizationCodeResponse(t);if(t.hasOwnProperty("error"))throw this.processErrorResponse(t)}},{key:"dump",value:function(){var e=this.store.getTokens(this.providerID);return{providerID:this.providerID,tokens:e,config:this.config}}},{key:"_getRequestScopes",value:function(e){var t,n=[];if(this.config.has("scopes.request")){var r=this.config.getValue("scopes.request");for(t=0;t<r.length;t++)n.push(r[t])}if(e&&e.scopes&&e.scopes.request)for(t=0;t<e.scopes.request.length;t++)n.push(e.scopes.request[t]);return a.default.uniqueList(n)}},{key:"_getRequiredScopes",value:function(e){var t,n=[];if(this.config.has("scopes.require")){var r=this.config.getValue("scopes.require");for(t=0;t<r.length;t++)n.push(r[t])}if(e&&e.scopes&&e.scopes.require)for(t=0;t<e.scopes.require.length;t++)n.push(e.scopes.require[t]);return a.default.uniqueList(n)}},{key:"getToken",value:function(e){var t=this;return e=e||{},new Promise(function(n,r){var o=t._getRequiredScopes(e),i=t.store.getToken(t.providerID,o);if(i)return n(i);if(e.hasOwnProperty("allowredir")&&!e.allowredir)throw new Error("Cannot obtain a token, when not allowed to redirect...");n(t._authorize(e))})}},{key:"checkToken",value:function(e){var t=this._getRequiredScopes(e);return this.store.getToken(this.providerID,t)}},{key:"_authorize",value:function(e){var t,n,r,o=this;return Promise.resolve().then(function(){var s,c=o.config.getValue("authorization",null,!0),u=o.config.getValue("client_id",null,!0);if(e.hasOwnProperty("allowia")||o.config.has("allowia"))throw new Error('The allowia option was removed in JSO 4.1.0. Instead use {request: {prompt: "none"}}');if(a.default.log("About to send an authorization request to this endpoint",c),a.default.log("Options",e),t={},o.config.has("request")){var l=o.config.getValue("request");t=(0,i.default)(t,l)}if(e.hasOwnProperty("request")&&(t=(0,i.default)(t,e.request)),t.response_type=e.response_type||o.config.getValue("response_type","id_token token"),t.state=a.default.uuid(),o.config.has("redirect_uri")&&(t.redirect_uri=o.config.getValue("redirect_uri","")),e.redirect_uri&&(t.redirect_uri=e.redirect_uri),t.client_id=u,s=(r=o._getRequestScopes(e)).includes("openid"),r.length>0&&(t.scope=a.default.scopeList(r)),a.default.log("Running in mode: "+(s?"OpenID Connect mode":"OAuth mode")),s&&!t.hasOwnProperty("redirect_uri"))throw new Error("An OpenID Request requires a redirect_uri to be set. Please add to configuration. A redirect_uri is not required for plain OAuth");s&&(t.nonce=a.default.uuid()),a.default.log("Debug Authentication request object",JSON.stringify(t,void 0,2)),n=a.default.encodeURL(c,t),window.location.hash&&(t.restoreHash=window.location.hash),t.providerID=o.providerID,r&&(t.scopes=r),a.default.log("Saving state ["+t.state+"]"),a.default.log(JSON.parse(JSON.stringify(t)));var f=o.Loader;return e.hasOwnProperty("loader")&&(f=e.loader),a.default.log("Looking for loader",e,f),o.store.saveState(t.state,t),o.gotoAuthorizeURL(n,f).then(function(e){if(!0!==e)return o.callback(e)})})}},{key:"gotoAuthorizeURL",value:function(e,t){return new Promise(function(n,r){if(null!==t&&"function"==typeof t){var o=new t(e);if(!(o instanceof c.default))throw new Error("JSO selected Loader is not an instance of BasicLoader.");n(o.execute())}else r(new Error("Cannot redirect to authorization endpoint because of missing redirect handler"))})}},{key:"wipeTokens",value:function(){this.store.wipeTokens(this.providerID)}}]),t}();t.JSO=b,t.BasicLoader=c.default,t.HTTPRedirect=u.default,t.Popup=f.default,t.IFramePassive=l.default,t.Fetcher=p.default,t.FetcherJQuery=h.default}])})},{}],ItemRoomScrollView:[function(e,t,n){"use strict";cc._RF.push(t,"c08569tFsJD4IL4dl1t47SV","ItemRoomScrollView"),Object.defineProperty(n,"__esModule",{value:!0}),e("../Script/ConnectionManager");var r=e("../Script/ConnectionManager"),o=cc._decorator,i=o.ccclass,s=o.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id=-1,t.roomSceneName="",t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.on("mousedown",function(t){r.default.getInstance().joinGame(e.id,!1)})},__decorate([s()],t.prototype,"roomSceneName",void 0),t=__decorate([i],t)}(cc.Component);n.default=a,cc._RF.pop()},{"../Script/ConnectionManager":"ConnectionManager"}],MainGameManager:[function(e,t,n){"use strict";cc._RF.push(t,"b3ccfocBzlMopwIcI0F0vp0","MainGameManager"),Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,i=r.property,s=e("./ConnectionManager"),a=e("./SnapGame"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.snapGameNode=null,t.cardPrefab=null,t.menuSceneName="",t.cardContainer=null,t.yourCards=null,t.popCardTouchNode=null,t.snapTouchNode=null,t.currentPlayerLabel=null,t.cardAtlas=null,t.cardBackPart=null,t.playerNamesContainer=null,t.rotateDirection=1,t}return __extends(t,e),t.prototype.onLoad=function(){this.connection=s.default.getInstance(),cc.systemEvent.on(s.default.ON_POP_CARD_MESSAGE,this.cardPop,this),cc.systemEvent.on(s.default.ON_SNAP_MESSAGE,this.onSnap,this),this.snapTouchNode.on("mousedown",this.snap,this),this.popCardTouchNode.on("mousedown",this.popCard,this),this.game=this.snapGameNode.getComponent(a.default)},t.prototype.onDestroy=function(){cc.systemEvent.off(s.default.ON_POP_CARD_MESSAGE,this.cardPop,this),cc.systemEvent.on(s.default.ON_SNAP_MESSAGE,this.onSnap,this)},t.prototype.cardPop=function(e){var t=e.getUserData();this.game.currentPlayer=t.currentPlayer;var n=t.card;cc.log("You are: "+this.connection.player.username+" and the current player is: "+this.game.currentPlayer),cc.log("card pop! type: "+n.type+" value: "+n.value),this.renderPopCardInCentralPile(n.type,n.value),this.currentPlayerLabel.string=this.game.currentPlayer,t.popBy===this.connection.player.username&&this.yourCards.children.length>0&&this.yourCards.removeChild(this.yourCards.children[0],!0)},t.prototype.renderPopCardInCentralPile=function(e,t){var n=cc.instantiate(this.cardPrefab),r=n.getComponent(cc.Sprite),o="slice_"+(e+1)+"_"+t;n.angle=this.rotateDirection*Math.random()*30,r.spriteFrame=this.cardAtlas.getSpriteFrame(o),this.cardContainer.addChild(n),this.rotateDirection=this.rotateDirection>=1?-1:1},t.prototype.snap=function(){this.connection.snap(this.game.gameId)},t.prototype.onSnap=function(e){var t=e.getUserData();if(t.username===this.connection.player.username){cc.log("YOU "+t.username+" HAVE SNAPPED"),this.yourCards.removeAllChildren();for(var n=0;n<t.playerCardsCount;n++){var r=cc.instantiate(this.cardPrefab);r.setPosition(new cc.Vec2(.01*n,.01*n)),this.yourCards.addChild(r)}}else cc.log("YEEKS, player "+t.username+" hava snapped :(");this.cardContainer.removeAllChildren()},t.prototype.loadData=function(){var e=this;cc.log("You are: "+this.connection.player.username+" and the current player is: "+this.game.currentPlayer),this.currentPlayerLabel.string=this.game.currentPlayer;for(var t=this.game.playerData.filter(function(t){return t.username===e.connection.player.username})[0],n=0;n<t.playersCardsCount;n++){var r=cc.instantiate(this.cardPrefab);r.setPosition(new cc.Vec2(.25*n,.25*n)),this.yourCards.addChild(r)}this.game.playerData.map(function(e){var t=new cc.Node,n=t.addComponent(cc.Label);return n.string=e.username,n.fontSize=24,n.lineHeight=24,t}).forEach(function(t){return e.playerNamesContainer.addChild(t)})},t.prototype.popCard=function(){this.connection.popCard(this.game.gameId)},t.prototype.exit=function(){cc.director.loadScene(this.menuSceneName)},__decorate([i(cc.Node)],t.prototype,"snapGameNode",void 0),__decorate([i(cc.Prefab)],t.prototype,"cardPrefab",void 0),__decorate([i()],t.prototype,"menuSceneName",void 0),__decorate([i(cc.Node)],t.prototype,"cardContainer",void 0),__decorate([i(cc.Node)],t.prototype,"yourCards",void 0),__decorate([i(cc.Node)],t.prototype,"popCardTouchNode",void 0),__decorate([i(cc.Node)],t.prototype,"snapTouchNode",void 0),__decorate([i(cc.Label)],t.prototype,"currentPlayerLabel",void 0),__decorate([i(cc.SpriteAtlas)],t.prototype,"cardAtlas",void 0),__decorate([i(cc.SpriteFrame)],t.prototype,"cardBackPart",void 0),__decorate([i(cc.Node)],t.prototype,"playerNamesContainer",void 0),t=__decorate([o],t)}(cc.Component);n.default=c,cc._RF.pop()},{"./ConnectionManager":"ConnectionManager","./SnapGame":"SnapGame"}],MainMenuManager:[function(e,t,n){"use strict";cc._RF.push(t,"4a09fwjIB9Fer1pcqIIHgoJ","MainMenuManager"),Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Prefabs/ItemRoomScrollView"),o=e("./ConnectionManager"),i=e("./SnapGame"),s=e("./WaitingRoomManager"),a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loginNameLbl=null,t.connectionStatusLbl=null,t.loginBtn=null,t.logoutBtn=null,t.reconnectBtn=null,t.itemPrefab=null,t.roomScrollView=null,t.roomSceneName="",t.connection=o.ConnectionManager.getInstance(),t}return __extends(t,e),t.prototype.onLoad=function(){cc.systemEvent.on(o.ConnectionManager.ON_CONNECTED,this.onConnected,this),cc.systemEvent.on(o.ConnectionManager.ON_CONNECTION_CLOSED,this.onDisconnected,this),cc.systemEvent.on(o.ConnectionManager.ON_PLAYER_LOGIN_EVENT,this.onLogin,this),cc.systemEvent.on(o.ConnectionManager.ON_CREATE_ROOM,this.onRoomCreated,this),cc.systemEvent.on(o.ConnectionManager.ON_JOIN_GAME_MESSAGE,this.onJoinGame,this),this.refresh()},t.prototype.onDestroy=function(){cc.systemEvent.off(o.ConnectionManager.ON_CONNECTED,this.onConnected,this),cc.systemEvent.off(o.ConnectionManager.ON_CONNECTION_CLOSED,this.onDisconnected,this),cc.systemEvent.off(o.ConnectionManager.ON_PLAYER_LOGIN_EVENT,this.onLogin,this),cc.systemEvent.off(o.ConnectionManager.ON_CREATE_ROOM,this.onRoomCreated,this),cc.systemEvent.off(o.ConnectionManager.ON_JOIN_GAME_MESSAGE,this.onJoinGame,this)},t.prototype.onJoinGame=function(e){var t=e.getUserData().username,n=e.getUserData().roomId;t===this.connection.player.username&&cc.director.loadScene(this.roomSceneName,function(){var e=cc.director.getScene(),t=e.getChildByName("Game").getComponent(i.default),r=e.getChildByName("WaitingRoomManager").getComponent(s.default);t.roomId=n,r.loadData()})},t.prototype.createRoom=function(){this.connection.createRoom()},t.prototype.onRoomCreated=function(e){var t=e.getUserData().roomId,n=e.getUserData().createdBy;n!==this.connection.player.username?this.addRoomItem(t):cc.director.loadScene(this.roomSceneName,function(){var e=cc.director.getScene(),r=e.getChildByName("Game").getComponent(i.default),o=e.getChildByName("WaitingRoomManager").getComponent(s.default);r.roomId=t,r.createdBy=n,o.loadData()})},t.prototype.addRoomItem=function(e){cc.log("Game created received: "+e);var t=cc.instantiate(this.itemPrefab);t.getComponent(r.default).id=e,t.getComponentInChildren(cc.Label).string="Room #"+e;var n=this.roomScrollView.content.childrenCount,o=t.height+5,i=n*o;this.roomScrollView.content.addChild(t),t.setPosition(0,-i),this.roomScrollView.content.height+=o},t.prototype.onConnected=function(e){this.connectionStatusLbl.string="Connected"},t.prototype.onDisconnected=function(e){this.connectionStatusLbl.string="Disconnected"},t.prototype.onLogin=function(e){this.loginNameLbl.string=this.connection.player.username},t.prototype.connect=function(){this.connection.connect()},t.prototype.refresh=function(){var e=this;this.connection.refresh(),fetch("https://localhost:44378/api/GameRoom").then(function(e){return e.json()}).then(function(t){t.forEach(function(t){e.addRoomItem(t.id)})})},t.prototype.login=function(){this.connection.login()},t.prototype.logout=function(){this.connection.logout()},__decorate([u(cc.Label)],t.prototype,"loginNameLbl",void 0),__decorate([u(cc.Label)],t.prototype,"connectionStatusLbl",void 0),__decorate([u(cc.Button)],t.prototype,"loginBtn",void 0),__decorate([u(cc.Button)],t.prototype,"logoutBtn",void 0),__decorate([u(cc.Button)],t.prototype,"reconnectBtn",void 0),__decorate([u(cc.Prefab)],t.prototype,"itemPrefab",void 0),__decorate([u(cc.ScrollView)],t.prototype,"roomScrollView",void 0),__decorate([u()],t.prototype,"roomSceneName",void 0),t=__decorate([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../Prefabs/ItemRoomScrollView":"ItemRoomScrollView","./ConnectionManager":"ConnectionManager","./SnapGame":"SnapGame","./WaitingRoomManager":"WaitingRoomManager"}],SnapGame:[function(e,t,n){"use strict";cc._RF.push(t,"a5751EyGXpFb7z8Z+Jt9PZr","SnapGame"),Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,i=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roomId=-1,t.createdBy="",t.gameId=-1,t.currentPlayer="",t.playerData={},t}return __extends(t,e),t=__decorate([o],t)}(cc.Component));n.default=i,cc._RF.pop()},{}],WaitingRoomManager:[function(e,t,n){"use strict";cc._RF.push(t,"761e34sVU9P5L936SCXovp9","WaitingRoomManager"),Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ConnectionManager");e("./ConnectionManager");var o=e("./SnapGame"),i=e("./MainGameManager"),s=cc._decorator,a=s.ccclass,c=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userPrefab=null,t.menuScene="",t.mainGameScene="",t.titleLabel=null,t.snapGameNode=null,t.playersPanelNode=null,t.game=null,t.connection=r.default.getInstance(),t}return __extends(t,e),t.prototype.onLoad=function(){cc.systemEvent.on(r.default.ON_START_GAME_MESSAGE,this.gameStarted,this),this.game=this.snapGameNode.getComponent(o.default),cc.systemEvent.on(r.default.ON_JOIN_GAME_MESSAGE,this.onJoinGame,this)},t.prototype.onDestroy=function(){cc.systemEvent.off(r.default.ON_START_GAME_MESSAGE,this.gameStarted,this),cc.systemEvent.off(r.default.ON_JOIN_GAME_MESSAGE,this.onJoinGame,this)},t.prototype.loadData=function(){var e=this;this.titleLabel.string="Room #"+this.game.roomId.toString(),fetch("https://localhost:44378/api/GameRoom/"+this.game.roomId).then(function(e){return e.json()}).then(function(t){t.roomPlayers.map(function(e){return e.player}).forEach(function(t){e.addPlayerItem(t.username)})})},t.prototype.onJoinGame=function(e){var t=e.getUserData().username;this.addPlayerItem(t)},t.prototype.startGame=function(){r.default.getInstance().startGame(this.game.roomId)},t.prototype.gameStarted=function(e){var t=e.getUserData(),n=t.gameId,r=t.currentPlayer;cc.director.loadScene(this.mainGameScene,function(){var e=cc.director.getScene(),s=e.getChildByName("MainGameManager").getComponent(i.default),a=e.getChildByName("Game").getComponent(o.default);a.gameId=n,a.currentPlayer=r,a.playerData=t.playerData,s.loadData()})},t.prototype.addPlayerItem=function(e){cc.log("User: "+e+" joined the match");var t=cc.instantiate(this.userPrefab);t.getChildByName("Label").getComponent(cc.Label).string=e.toString(),this.playersPanelNode.addChild(t)},t.prototype.back=function(){cc.director.loadScene(this.menuScene)},t.prototype.deleteRoom=function(){throw"Not yet implemented"},__decorate([c(cc.Prefab)],t.prototype,"userPrefab",void 0),__decorate([c()],t.prototype,"menuScene",void 0),__decorate([c()],t.prototype,"mainGameScene",void 0),__decorate([c(cc.Label)],t.prototype,"titleLabel",void 0),__decorate([c(cc.Node)],t.prototype,"snapGameNode",void 0),__decorate([c(cc.Node)],t.prototype,"playersPanelNode",void 0),t=__decorate([a],t)}(cc.Component);n.default=u,cc._RF.pop()},{"./ConnectionManager":"ConnectionManager","./MainGameManager":"MainGameManager","./SnapGame":"SnapGame"}]},{},["ItemRoomScrollView","ConnectionManager","MainGameManager","MainMenuManager","SnapGame","WaitingRoomManager"]);