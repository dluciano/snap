window.__require=function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u=s.split("/");if(u=u[u.length-1],!t[u]){var c="function"==typeof __require&&__require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+s+"'")}}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){return o(t[s][1][e]||e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){"use strict";r.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){for(var t,r=c(e),n=r[0],s=r[1],a=new i(function(e,t,r){return 3*(t+r)/4-r}(0,n,s)),u=0,l=s>0?n-4:n,f=0;f<l;f+=4)t=o[e.charCodeAt(f)]<<18|o[e.charCodeAt(f+1)]<<12|o[e.charCodeAt(f+2)]<<6|o[e.charCodeAt(f+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;2===s&&(t=o[e.charCodeAt(f)]<<2|o[e.charCodeAt(f+1)]>>4,a[u++]=255&t);1===s&&(t=o[e.charCodeAt(f)]<<10|o[e.charCodeAt(f+1)]<<4|o[e.charCodeAt(f+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t);return a},r.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],s=0,a=r-o;s<a;s+=16383)i.push(f(e,s,s+16383>a?a:s+16383));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)n[a]=s[a],o[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function f(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(n));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],2:[function(e,t,r){(function(t){"use strict";var n=e("base64-js"),o=e("ieee754"),i=e("isarray");function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=h(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|g(t,r),o=(e=a(e,n)).write(t,r);o!==n&&(e=e.slice(0,o));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|p(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|p(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function g(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(n)return F(e).length;t=(""+t).toLowerCase(),n=!0}}function d(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,o);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,o){var i,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=r;i<a;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var f=!0,h=0;h<u;h++)if(c(e,i+h)!==c(t,h)){f=!1;break}if(f)return i}return-1}function b(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function w(e,t,r,n){return q(F(t,e.length-r),e,r,n)}function m(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return m(e,t,r,n)}function T(e,t,r,n){return q(N(t),e,r,n)}function S(e,t,r,n){return q(function(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,s,a,u,c=e[o],l=null,f=c>239?4:c>223?3:c>191?2:1;if(o+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=f}return function(e){var t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=P));return r}(n)}r.Buffer=u,r.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},r.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),r.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return c(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return f(null,e)},u.allocUnsafeSlow=function(e){return f(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var s=e[r];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)d(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)d(this,t,t+3),d(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)d(this,t,t+7),d(this,t+1,t+6),d(this,t+2,t+5),d(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return L(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,o){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var i=o-n,s=r-t,a=Math.min(i,s),c=this.slice(n,o),l=e.slice(t,r),f=0;f<a;++f)if(c[f]!==l[f]){i=c[f],s=l[f];break}return i<s?-1:s<i?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":return m(this,e,t,r);case"latin1":case"binary":return _(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function L(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function O(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=B(e[i]);return o}function x(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,o,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function j(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function R(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function M(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(e,t,r,n,i){return i||M(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,i){return i||M(e,0,r,8),o.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var o=t-e;r=new u(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},u.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);A(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);A(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return H(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return H(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=u.isBuffer(e)?e:F(new u(e,n).toString()),a=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function N(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:4,isarray:3}],3:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],4:[function(e,t,r){r.read=function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,l=-7,f=r?o-1:0,h=r?-1:1,p=e[t+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=a;l>0;i=256*i+e[t+f],f+=h,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=c}return(p?-1:1)*s*Math.pow(2,i-n)},r.write=function(e,t,r,n,o,i){var s,a,u,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,g=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,o),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;e[r+p]=255&a,p+=g,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[r+p]=255&s,p+=g,s/=256,c-=8);e[r+p-g]|=128*d}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}();r.AbortController=n},{}],6:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o,i=e("./Errors"),s=e("./HttpClient"),a=e("./XhrHttpClient");if("undefined"==typeof XMLHttpRequest){var u="function"==typeof __webpack_require__?__non_webpack_require__:e;o=u("./NodeHttpClient")}var c=function(e){function t(t){var r=e.call(this)||this;if("undefined"!=typeof XMLHttpRequest)r.httpClient=new a.XhrHttpClient(t);else{if(void 0===o)throw new Error("No HttpClient could be created.");r.httpClient=new o.NodeHttpClient(t)}return r}return n(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new i.AbortError):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(s.HttpClient);r.DefaultHttpClient=c},{"./Errors":7,"./HttpClient":9,"./XhrHttpClient":23}],7:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=this,o=this.constructor.prototype;return(n=e.call(this,t)||this).statusCode=r,n.__proto__=o,n}return n(t,e),t}(Error);r.HttpError=o;var i=function(e){function t(t){var r=this.constructor;void 0===t&&(t="A timeout occurred.");var n=this,o=r.prototype;return(n=e.call(this,t)||this).__proto__=o,n}return n(t,e),t}(Error);r.TimeoutError=i;var s=function(e){function t(t){var r=this.constructor;void 0===t&&(t="An abort occurred.");var n=this,o=r.prototype;return(n=e.call(this,t)||this).__proto__=o,n}return n(t,e),t}(Error);r.AbortError=s},{}],8:[function(e,t,r){(function(t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./TextMessageFormat"),o=e("./Utils"),i=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return n.TextMessageFormat.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var r,i;if(o.isArrayBuffer(e)||void 0!==t&&e instanceof t){var s=new Uint8Array(e);if(-1===(u=s.indexOf(n.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=u+1;r=String.fromCharCode.apply(null,s.slice(0,a)),i=s.byteLength>a?s.slice(a).buffer:null}else{var u,c=e;if(-1===(u=c.indexOf(n.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");a=u+1;r=c.substring(0,a),i=c.length>a?c.substring(a):null}var l=n.TextMessageFormat.parse(r),f=JSON.parse(l[0]);if(f.type)throw new Error("Expected a handshake response from the server.");return[i,f]},e}();r.HandshakeProtocol=i}).call(this,e("buffer").Buffer)},{"./TextMessageFormat":20,"./Utils":21,buffer:2}],9:[function(e,t,r){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(r,"__esModule",{value:!0});var o=function(){return function(e,t,r){this.statusCode=e,this.statusText=t,this.content=r}}();r.HttpResponse=o;var i=function(){function e(){}return e.prototype.get=function(e,t){return this.send(n({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(n({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(n({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}();r.HttpClient=i},{}],10:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./DefaultHttpClient"),s=e("./ILogger"),a=e("./ITransport"),u=e("./LongPollingTransport"),c=e("./ServerSentEventsTransport"),l=e("./Utils"),f=e("./WebSocketTransport"),h=null,p=null;if("undefined"==typeof window&&void 0!==e){var g="function"==typeof __webpack_require__?__non_webpack_require__:e;h=g("ws"),p=g("eventsource")}var d=function(){function e(e,t){void 0===t&&(t={}),this.features={},l.Arg.isRequired(e,"url"),this.logger=l.createLogger(t.logger),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent||!1;var r="undefined"==typeof window;r||"undefined"==typeof WebSocket||t.WebSocket?r&&!t.WebSocket&&h&&(t.WebSocket=h):t.WebSocket=WebSocket,r||"undefined"==typeof EventSource||t.EventSource?r&&!t.EventSource&&void 0!==p&&(t.EventSource=p):t.EventSource=EventSource,this.httpClient=t.httpClient||new i.DefaultHttpClient(this.logger),this.connectionState=2,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return e=e||a.TransferFormat.Binary,l.Arg.isIn(e,a.TransferFormat,"transferFormat"),this.logger.log(s.LogLevel.Debug,"Starting connection with transfer format '"+a.TransferFormat[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return n(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:this.connectionState=2,this.stopError=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:t.sent(),this.transport=void 0,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return n(this,void 0,void 0,function(){var t,r,n,i,c,l,f,h=this;return o(this,function(p){switch(p.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,p.label=1;case 1:return p.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==a.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(a.HttpTransportType.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return p.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:r=null,n=0,i=function(){var e;return o(this,function(o){switch(o.label){case 0:return[4,c.getNegotiationResponse(t)];case 1:if(r=o.sent(),2===c.connectionState)return[2,{value:void 0}];if(r.error)throw Error(r.error);if(r.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return r.url&&(t=r.url),r.accessToken&&(e=r.accessToken,c.accessTokenFactory=function(){return e}),n++,[2]}})},c=this,p.label=6;case 6:return[5,i()];case 7:if("object"==typeof(l=p.sent()))return[2,l.value];p.label=8;case 8:if(r.url&&n<100)return[3,6];p.label=9;case 9:if(100===n&&r.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,r,e)];case 10:p.sent(),p.label=11;case 11:return this.transport instanceof u.LongPollingTransport&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return h.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw f=p.sent(),this.logger.log(s.LogLevel.Error,"Failed to start the connection: "+f),this.connectionState=2,this.transport=void 0,f;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return n(this,void 0,void 0,function(){var t,r,n,i,a,u;return o(this,function(o){switch(o.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&((t={}).Authorization="Bearer "+n,r=t),o.label=2;case 2:i=this.resolveNegotiateUrl(e),this.logger.log(s.LogLevel.Debug,"Sending negotiation request: "+i+"."),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.httpClient.post(i,{content:"",headers:r})];case 4:if(200!==(a=o.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+a.statusCode);return[2,JSON.parse(a.content)];case 5:throw u=o.sent(),this.logger.log(s.LogLevel.Error,"Failed to complete negotiation with the server: "+u),u;case 6:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,r,i){return n(this,void 0,void 0,function(){var n,u,c,l,f,h,p;return o(this,function(o){switch(o.label){case 0:return n=this.createConnectUrl(e,r.connectionId),this.isITransport(t)?(this.logger.log(s.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(n,i)]):[3,2];case 1:return o.sent(),this.changeState(0,1),[2];case 2:u=r.availableTransports||[],c=0,l=u,o.label=3;case 3:return c<l.length?(f=l[c],this.connectionState=0,"number"!=typeof(h=this.resolveTransport(f,t,i))?[3,8]:(this.transport=this.constructTransport(h),r.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:r=o.sent(),n=this.createConnectUrl(e,r.connectionId),o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.transport.connect(n,i)];case 6:return o.sent(),this.changeState(0,1),[2];case 7:return p=o.sent(),this.logger.log(s.LogLevel.Error,"Failed to start the transport '"+a.HttpTransportType[h]+"': "+p),this.connectionState=2,r.connectionId=void 0,[3,8];case 8:return c++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case a.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new f.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case a.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new c.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case a.HttpTransportType.LongPolling:return new u.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,r){var n=a.HttpTransportType[e.transport];if(null===n||void 0===n)this.logger.log(s.LogLevel.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var o=e.transferFormats.map(function(e){return a.TransferFormat[e]});if(function(e,t){return!e||0!=(t&e)}(t,n))if(o.indexOf(r)>=0){if((n!==a.HttpTransportType.WebSockets||this.options.WebSocket)&&(n!==a.HttpTransportType.ServerSentEvents||this.options.EventSource))return this.logger.log(s.LogLevel.Debug,"Selecting transport '"+a.HttpTransportType[n]+"'."),n;this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it is not supported in your environment.'")}else this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it does not support the requested transfer format '"+a.TransferFormat[r]+"'.");else this.logger.log(s.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){this.transport=void 0,(e=this.stopError||e)?this.logger.log(s.LogLevel.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(s.LogLevel.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e)},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(s.LogLevel.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),r=e.substring(0,-1===t?e.length:t);return"/"!==r[r.length-1]&&(r+="/"),r+="negotiate",r+=-1===t?"":e.substring(t)},e}();r.HttpConnection=d},{"./DefaultHttpClient":6,"./ILogger":14,"./ITransport":15,"./LongPollingTransport":18,"./ServerSentEventsTransport":19,"./Utils":21,"./WebSocketTransport":22}],11:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i,s=e("./HandshakeProtocol"),a=e("./IHubProtocol"),u=e("./ILogger"),c=e("./Utils"),l=3e4,f=15e3;(function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected"})(i=r.HubConnectionState||(r.HubConnectionState={}));var h=function(){function e(e,t,r){var n=this;c.Arg.isRequired(e,"connection"),c.Arg.isRequired(t,"logger"),c.Arg.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=l,this.keepAliveIntervalInMilliseconds=f,this.logger=t,this.protocol=r,this.connection=e,this.handshakeProtocol=new s.HandshakeProtocol,this.connection.onreceive=function(e){return n.processIncomingData(e)},this.connection.onclose=function(e){return n.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=i.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:a.MessageType.Ping})}return e.create=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),e.prototype.start=function(){return n(this,void 0,void 0,function(){var e,t,r=this;return o(this,function(n){switch(n.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(u.LogLevel.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,t=new Promise(function(e,t){r.handshakeResolver=e,r.handshakeRejecter=t}),[4,this.connection.start(this.protocol.transferFormat)];case 1:return n.sent(),this.logger.log(u.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return n.sent(),this.logger.log(u.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 3:return n.sent(),this.connectionState=i.Connected,[2]}})})},e.prototype.stop=function(){return this.logger.log(u.LogLevel.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.createStreamInvocation(e,r),i=new c.Subject(function(){var e=t.createCancelInvocation(o.invocationId),r=t.protocol.writeMessage(e);return delete t.callbacks[o.invocationId],t.sendMessage(r)});this.callbacks[o.invocationId]=function(e,t){t?i.error(t):e&&(e.type===a.MessageType.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))};var s=this.protocol.writeMessage(o);return this.sendMessage(s).catch(function(e){i.error(e),delete t.callbacks[o.invocationId]}),i},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.send=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.createInvocation(e,t,!0),o=this.protocol.writeMessage(n);return this.sendMessage(o)},e.prototype.invoke=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.createInvocation(e,r,!1);return new Promise(function(e,r){t.callbacks[o.invocationId]=function(t,n){n?r(n):t&&(t.type===a.MessageType.Completion?t.error?r(new Error(t.error)):e(t.result):r(new Error("Unexpected message type: "+t.type)))};var n=t.protocol.writeMessage(o);t.sendMessage(n).catch(function(e){r(e),delete t.callbacks[o.invocationId]})})},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var r=this.methods[e];if(r)if(t){var n=r.indexOf(t);-1!==n&&(r.splice(n,1),0===r.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,r=this.protocol.parseMessages(e,this.logger);t<r.length;t++){var n=r[t];switch(n.type){case a.MessageType.Invocation:this.invokeClientMethod(n);break;case a.MessageType.StreamItem:case a.MessageType.Completion:var o=this.callbacks[n.invocationId];null!=o&&(n.type===a.MessageType.Completion&&delete this.callbacks[n.invocationId],o(n));break;case a.MessageType.Ping:break;case a.MessageType.Close:this.logger.log(u.LogLevel.Information,"Close message received from server."),this.connection.stop(n.error?new Error("Server returned an error on close: "+n.error):void 0);break;default:this.logger.log(u.LogLevel.Warning,"Invalid message type: "+n.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,r,n;try{n=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],r=t[1]}catch(e){var o="Error parsing handshake response: "+e;this.logger.log(u.LogLevel.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(r.error){o="Server returned handshake error: "+r.error;throw this.logger.log(u.LogLevel.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o)}return this.logger.log(u.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),n},e.prototype.resetKeepAliveInterval=function(){var e=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return n(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:if(this.connectionState!==i.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},e.prototype.resetTimeoutPeriod=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,r=this.methods[e.target.toLowerCase()];if(r){if(r.forEach(function(r){return r.apply(t,e.arguments)}),e.invocationId){var n="Server requested a response, which is not supported in this version of the client.";this.logger.log(u.LogLevel.Error,n),this.connection.stop(new Error(n))}}else this.logger.log(u.LogLevel.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,r=this.callbacks;this.callbacks={},this.connectionState=i.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(e),Object.keys(r).forEach(function(t){(0,r[t])(null,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach(function(r){return r.apply(t,[e])})},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,r){if(r)return{arguments:t,target:e,type:a.MessageType.Invocation};var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:a.MessageType.Invocation}},e.prototype.createStreamInvocation=function(e,t){var r=this.id;return this.id++,{arguments:t,invocationId:r.toString(),target:e,type:a.MessageType.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:a.MessageType.CancelInvocation}},e}();r.HubConnection=h},{"./HandshakeProtocol":8,"./IHubProtocol":13,"./ILogger":14,"./Utils":21}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./HttpConnection"),o=e("./HubConnection"),i=e("./JsonHubProtocol"),s=e("./Loggers"),a=e("./Utils"),u=function(){function e(){}return e.prototype.configureLogging=function(e){return a.Arg.isRequired(e,"logging"),!function(e){return void 0!==e.log}(e)?this.logger=new a.ConsoleLogger(e):this.logger=e,this},e.prototype.withUrl=function(e,t){return a.Arg.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return a.Arg.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new n.HttpConnection(this.url,e);return o.HubConnection.create(t,this.logger||s.NullLogger.instance,this.protocol||new i.JsonHubProtocol)},e}();r.HubConnectionBuilder=u},{"./HttpConnection":10,"./HubConnection":11,"./JsonHubProtocol":16,"./Loggers":17,"./Utils":21}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(r.MessageType||(r.MessageType={}))},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(r.LogLevel||(r.LogLevel={}))},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(r.HttpTransportType||(r.HttpTransportType={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(r.TransferFormat||(r.TransferFormat={}))},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./IHubProtocol"),o=e("./ILogger"),i=e("./ITransport"),s=e("./Loggers"),a=e("./TextMessageFormat"),u="json",c=function(){function e(){this.name=u,this.version=1,this.transferFormat=i.TransferFormat.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=s.NullLogger.instance);for(var r=[],i=0,u=a.TextMessageFormat.parse(e);i<u.length;i++){var c=u[i],l=JSON.parse(c);if("number"!=typeof l.type)throw new Error("Invalid payload.");switch(l.type){case n.MessageType.Invocation:this.isInvocationMessage(l);break;case n.MessageType.StreamItem:this.isStreamItemMessage(l);break;case n.MessageType.Completion:this.isCompletionMessage(l);break;case n.MessageType.Ping:case n.MessageType.Close:break;default:t.log(o.LogLevel.Information,"Unknown message type '"+l.type+"' ignored.");continue}r.push(l)}return r},e.prototype.writeMessage=function(e){return a.TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}();r.JsonHubProtocol=c},{"./IHubProtocol":13,"./ILogger":14,"./ITransport":15,"./Loggers":17,"./TextMessageFormat":20}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}();r.NullLogger=n},{}],18:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./AbortController"),s=e("./Errors"),a=e("./ILogger"),u=e("./ITransport"),c=e("./Utils"),l=function(){function e(e,t,r,n){this.httpClient=e,this.accessTokenFactory=t,this.logger=r,this.pollAbort=new i.AbortController,this.logMessageContent=n,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return n(this,void 0,void 0,function(){var r,n,i,l;return o(this,function(o){switch(o.label){case 0:if(c.Arg.isRequired(e,"url"),c.Arg.isRequired(t,"transferFormat"),c.Arg.isIn(t,u.TransferFormat,"transferFormat"),this.url=e,this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Connecting."),t===u.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return r={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},t===u.TransferFormat.Binary&&(r.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return n=o.sent(),this.updateHeaderToken(r,n),i=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+i+"."),[4,this.httpClient.get(i,r)];case 2:return 200!==(l=o.sent()).statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+l.statusCode+"."),this.closeError=new s.HttpError(l.statusText||"",l.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,r),[2]}})})},e.prototype.getAccessToken=function(){return n(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}})})},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return n(this,void 0,void 0,function(){var r,n,i,u;return o(this,function(o){switch(o.label){case 0:o.trys.push([0,,8,9]),o.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:r=o.sent(),this.updateHeaderToken(t,r),o.label=3;case 3:return o.trys.push([3,5,,6]),n=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+n+"."),[4,this.httpClient.get(n,t)];case 4:return 204===(i=o.sent()).statusCode?(this.logger.log(a.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==i.statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode+"."),this.closeError=new s.HttpError(i.statusText||"",i.statusCode),this.running=!1):i.content?(this.logger.log(a.LogLevel.Trace,"(LongPolling transport) data received. "+c.getDataDetail(i.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(i.content)):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return u=o.sent(),this.running?u instanceof s.TimeoutError?this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=u,this.running=!1):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+u.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},e.prototype.send=function(e){return n(this,void 0,void 0,function(){return o(this,function(t){return this.running?[2,c.sendMessage(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return n(this,void 0,void 0,function(){var e,t;return o(this,function(r){switch(r.label){case 0:this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),r.label=1;case 1:return r.trys.push([1,,5,6]),[4,this.receiving];case 2:return r.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return t=r.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 4:return r.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(a.LogLevel.Trace,e),this.onclose(this.closeError)}},e}();r.LongPollingTransport=l},{"./AbortController":5,"./Errors":7,"./ILogger":14,"./ITransport":15,"./Utils":21}],19:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./ITransport"),a=e("./Utils"),u=function(){function e(e,t,r,n,o){this.httpClient=e,this.accessTokenFactory=t,this.logger=r,this.logMessageContent=n,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return n(this,void 0,void 0,function(){var r,n=this;return o(this,function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,s.TransferFormat,"transferFormat"),this.logger.log(i.LogLevel.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),o.label=2;case 2:return[2,new Promise(function(r,o){var u=!1;if(t===s.TransferFormat.Text){var c;if("undefined"!=typeof window)c=new n.eventSourceConstructor(e,{withCredentials:!0});else{var l=n.httpClient.getCookieString(e);c=new n.eventSourceConstructor(e,{withCredentials:!0,headers:{Cookie:l}})}try{c.onmessage=function(e){if(n.onreceive)try{n.logger.log(i.LogLevel.Trace,"(SSE transport) data received. "+a.getDataDetail(e.data,n.logMessageContent)+"."),n.onreceive(e.data)}catch(e){return void n.close(e)}},c.onerror=function(e){var t=new Error(e.data||"Error occurred");u?n.close(t):o(t)},c.onopen=function(){n.logger.log(i.LogLevel.Information,"SSE connected to "+n.url),n.eventSource=c,u=!0,r()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},e.prototype.send=function(e){return n(this,void 0,void 0,function(){return o(this,function(t){return this.eventSource?[2,a.sendMessage(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}();r.ServerSentEventsTransport=u},{"./ILogger":14,"./ITransport":15,"./Utils":21}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var r=t.split(e.RecordSeparator);return r.pop(),r},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}();r.TextMessageFormat=n},{}],21:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./Loggers"),a=function(){function e(){}return e.isRequired=function(e,t){if(null===e||void 0===e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,r){if(!(e in t))throw new Error("Unknown "+r+" value: "+e+".")},e}();function u(e,t){var r="";return l(e)?(r="Binary data of length "+e.byteLength,t&&(r+=". Content: '"+c(e)+"'")):"string"==typeof e&&(r="String data of length "+e.length,t&&(r+=". Content: '"+e+"'")),r}function c(e){var t="";return new Uint8Array(e).forEach(function(e){t+="0x"+(e<16?"0":"")+e.toString(16)+" "}),t.substr(0,t.length-1)}function l(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}r.Arg=a,r.getDataDetail=u,r.formatArrayBuffer=c,r.isArrayBuffer=l,r.sendMessage=function(e,t,r,s,a,c,f){return n(this,void 0,void 0,function(){var n,h,p,g,d;return o(this,function(o){switch(o.label){case 0:return a?[4,a()]:[3,2];case 1:(p=o.sent())&&((n={}).Authorization="Bearer "+p,h=n),o.label=2;case 2:return e.log(i.LogLevel.Trace,"("+t+" transport) sending data. "+u(c,f)+"."),g=l(c)?"arraybuffer":"text",[4,r.post(s,{content:c,headers:h,responseType:g})];case 3:return d=o.sent(),e.log(i.LogLevel.Trace,"("+t+" transport) request complete. Response status: "+d.statusCode+"."),[2]}})})},r.createLogger=function(e){return void 0===e?new p(i.LogLevel.Information):null===e?s.NullLogger.instance:e.log?e:new p(e)};var f=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,r=this.observers;t<r.length;t++){r[t].next(e)}},e.prototype.error=function(e){for(var t=0,r=this.observers;t<r.length;t++){var n=r[t];n.error&&n.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var r=t[e];r.complete&&r.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new h(this,e)},e}();r.Subject=f;var h=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}();r.SubjectSubscription=h;var p=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case i.LogLevel.Critical:case i.LogLevel.Error:console.error("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;case i.LogLevel.Warning:console.warn("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;case i.LogLevel.Information:console.info("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t);break;default:console.log("["+(new Date).toISOString()+"] "+i.LogLevel[e]+": "+t)}},e}();r.ConsoleLogger=p},{"./ILogger":14,"./Loggers":17}],22:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./ILogger"),s=e("./ITransport"),a=e("./Utils"),u=function(){function e(e,t,r,n,o){this.logger=r,this.accessTokenFactory=t,this.logMessageContent=n,this.webSocketConstructor=o,this.httpClient=e,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return n(this,void 0,void 0,function(){var r,n=this;return o(this,function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,s.TransferFormat,"transferFormat"),this.logger.log(i.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),o.label=2;case 2:return[2,new Promise(function(r,o){var u;e=e.replace(/^http/,"ws");var c=n.httpClient.getCookieString(e);"undefined"==typeof window&&c&&(u=new n.webSocketConstructor(e,void 0,{headers:{Cookie:""+c}})),u||(u=new n.webSocketConstructor(e)),t===s.TransferFormat.Binary&&(u.binaryType="arraybuffer"),u.onopen=function(t){n.logger.log(i.LogLevel.Information,"WebSocket connected to "+e+"."),n.webSocket=u,r()},u.onerror=function(e){var t=null;"undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent&&(t=e.error),o(t)},u.onmessage=function(e){n.logger.log(i.LogLevel.Trace,"(WebSockets transport) data received. "+a.getDataDetail(e.data,n.logMessageContent)+"."),n.onreceive&&n.onreceive(e.data)},u.onclose=function(e){return n.close(e)}})]}})})},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(i.LogLevel.Trace,"(WebSockets transport) sending data. "+a.getDataDetail(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},e.prototype.close=function(e){this.logger.log(i.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!e||!1!==e.wasClean&&1e3===e.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e}();r.WebSocketTransport=u},{"./ILogger":14,"./ITransport":15,"./Utils":21}],23:[function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=e("./Errors"),i=e("./HttpClient"),s=e("./ILogger"),a=function(e){function t(t){var r=e.call(this)||this;return r.logger=t,r}return n(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new o.AbortError):e.method?e.url?new Promise(function(r,n){var a=new XMLHttpRequest;a.open(e.method,e.url,!0),a.withCredentials=!0,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var u=e.headers;u&&Object.keys(u).forEach(function(e){a.setRequestHeader(e,u[e])}),e.responseType&&(a.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){a.abort(),n(new o.AbortError)}),e.timeout&&(a.timeout=e.timeout),a.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),a.status>=200&&a.status<300?r(new i.HttpResponse(a.status,a.statusText,a.response||a.responseText)):n(new o.HttpError(a.statusText,a.status))},a.onerror=function(){t.logger.log(s.LogLevel.Warning,"Error from HTTP request. "+a.status+": "+a.statusText+"."),n(new o.HttpError(a.statusText,a.status))},a.ontimeout=function(){t.logger.log(s.LogLevel.Warning,"Timeout from HTTP request."),n(new o.TimeoutError)},a.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(i.HttpClient);r.XhrHttpClient=a},{"./Errors":7,"./HttpClient":9,"./ILogger":14}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION="1.1.2";var n=e("./Errors");r.AbortError=n.AbortError,r.HttpError=n.HttpError,r.TimeoutError=n.TimeoutError;var o=e("./HttpClient");r.HttpClient=o.HttpClient,r.HttpResponse=o.HttpResponse;var i=e("./DefaultHttpClient");r.DefaultHttpClient=i.DefaultHttpClient;var s=e("./HubConnection");r.HubConnection=s.HubConnection,r.HubConnectionState=s.HubConnectionState;var a=e("./HubConnectionBuilder");r.HubConnectionBuilder=a.HubConnectionBuilder;var u=e("./IHubProtocol");r.MessageType=u.MessageType;var c=e("./ILogger");r.LogLevel=c.LogLevel;var l=e("./ITransport");r.HttpTransportType=l.HttpTransportType,r.TransferFormat=l.TransferFormat;var f=e("./Loggers");r.NullLogger=f.NullLogger;var h=e("./JsonHubProtocol");r.JsonHubProtocol=h.JsonHubProtocol},{"./DefaultHttpClient":6,"./Errors":7,"./HttpClient":9,"./HubConnection":11,"./HubConnectionBuilder":12,"./IHubProtocol":13,"./ILogger":14,"./ITransport":15,"./JsonHubProtocol":16,"./Loggers":17}],25:[function(e,t,r){!function(e,n){"object"==typeof r&&"object"==typeof t?t.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof r?r.jso=n():e.jso=n()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}([function(e,t,r){var n=r(40)("wks"),o=r(25),i=r(1).Symbol,s="function"==typeof i;(e.exports=function(e){return n[e]||(n[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=n},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){var r=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=r)},function(e,t,r){var n=r(10);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n=r(16),o=r(44);e.exports=r(9)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(1),o=r(2),i=r(4),s=r(8),a=r(15),u=function(e,t,r){var c,l,f,h,p=e&u.F,g=e&u.G,d=e&u.S,v=e&u.P,y=e&u.B,b=g?n:d?n[t]||(n[t]={}):(n[t]||{}).prototype,w=g?o:o[t]||(o[t]={}),m=w.prototype||(w.prototype={});for(c in g&&(r=t),r)f=((l=!p&&b&&void 0!==b[c])?b:r)[c],h=y&&l?a(f,n):v&&"function"==typeof f?a(Function.call,f):f,b&&s(b,c,f,e&u.U),w[c]!=f&&i(w,c,h),v&&m[c]!=f&&(m[c]=f)};n.core=o,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t){e.exports={}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(1),o=r(4),i=r(7),s=r(25)("src"),a=Function.toString,u=(""+a).split("toString");r(2).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,r,a){var c="function"==typeof r;c&&(i(r,"name")||o(r,"name",t)),e[t]!==r&&(c&&(i(r,s)||o(r,s,e[t]?""+e[t]:u.join(String(t)))),e===n?e[t]=r:a?e[t]?e[t]=r:o(e,t,r):(delete e[t],o(e,t,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,r){e.exports=!r(27)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.log("Initializing a loader with url "+t),this.url=t}return n(e,[{key:"execute",value:function(){}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={epoch:function(){return Math.round((new Date).getTime()/1e3)},debug:!1,uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getResponseFromURL:function(e){return-1!==e.indexOf("#")?n.parseQueryString(e.substring(e.indexOf("#")+1)):-1!==e.indexOf("?")?n.parseQueryString(e.substring(e.indexOf("?")+1)):{}},parseQueryString:function(e){for(var t,r=/\+/g,n=/([^&;=]+)=?([^&;]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i=e,s={};t=n.exec(i);)s[o(t[1])]=o(t[2]);return s},scopeList:function(e){return n.uniqueList(e).join(" ")},uniqueList:function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]=1;for(var o in t)t.hasOwnProperty(o)&&r.push(o);return r},log:function(e){if(console&&console.log&&n.debug){var t=Array.prototype.slice.call(arguments);t.unshift("[JSO]"),console.log.apply(console,t)}},encodeQS:function(e){var t,r="",n=0;for(t in e)r+=(0==n++?"":"&")+encodeURIComponent(t)+"="+encodeURIComponent(e[t]);return r},encodeURL:function(e,t){var r,n=e,o=0,i=-1===e.indexOf("?")?"?":"&";for(r in t)n+=(0==o++?i:"&")+encodeURIComponent(r)+"="+encodeURIComponent(t[r]);return n}};t.default=n},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(14);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(3),o=r(87),i=r(86),s=Object.defineProperty;t.f=r(9)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";var n=r(14);e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},function(e,t,r){var n=r(16).f,o=r(7),i=r(0)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},function(e,t,r){var n=r(13),o=r(0)("toStringTag"),i="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?r:i?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){var n=r(40)("keys"),o=r(25);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(43),o=r(22);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(84),o=r(39);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(10),o=r(1).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[r]=t[r]}return n(e,[{key:"set",value:function(e,t){return this[e]=t,this}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=(n=r(28))&&n.__esModule?n:{default:n},i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();t.default=i},function(e,t,r){var n=r(3),o=r(10),i=r(17);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n,o,i,s=r(15),a=r(61),u=r(34),c=r(26),l=r(1),f=l.process,h=l.setImmediate,p=l.clearImmediate,g=l.MessageChannel,d=l.Dispatch,v=0,y={},b=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},w=function(e){b.call(e.data)};h&&p||(h=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return y[++v]=function(){a("function"==typeof e?e:Function(e),t)},n(v),v},p=function(e){delete y[e]},"process"==r(13)(f)?n=function(e){f.nextTick(s(b,e,1))}:d&&d.now?n=function(e){d.now(s(b,e,1))}:g?(i=(o=new g).port2,o.port1.onmessage=w,n=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",w,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),e.exports={set:h,clear:p}},function(e,t,r){var n=r(3),o=r(14),i=r(0)("species");e.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||void 0==(r=n(s)[i])?t:o(r)}},function(e,t,r){var n=r(1).document;e.exports=n&&n.documentElement},function(e,t){e.exports=!1},function(e,t,r){"use strict";var n=r(35),o=r(5),i=r(8),s=r(4),a=r(7),u=r(6),c=r(74),l=r(18),f=r(71),h=r(0)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};e.exports=function(e,t,r,d,v,y,b){c(r,t,d);var w,m,_,T=function(e){if(!p&&e in P)return P[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},S=t+" Iterator",k="values"==v,E=!1,P=e.prototype,L=P[h]||P["@@iterator"]||v&&P[v],C=!p&&L||T(v),O=v?k?T("entries"):C:void 0,x="Array"==t&&P.entries||L;if(x&&(_=f(x.call(new e)))!==Object.prototype&&_.next&&(l(_,S,!0),n||a(_,h)||s(_,h,g)),k&&L&&"values"!==L.name&&(E=!0,C=function(){return L.call(this)}),n&&!b||!p&&!E&&P[h]||s(P,h,C),u[t]=C,u[S]=g,v)if(w={values:k?C:T("values"),keys:y?C:T("keys"),entries:O},b)for(m in w)m in P||i(P,m,w[m]);else o(o.P+o.F*(p||E),t,w);return w}},function(e,t,r){var n=r(0)("unscopables"),o=Array.prototype;void 0==o[n]&&r(4)(o,n,{}),e.exports=function(e){o[n][e]=!0}},function(e,t,r){var n=r(22);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(1),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t,r){var n=r(21),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(23),o=r(41),i=r(83);e.exports=function(e){return function(t,r,s){var a,u=n(t),c=o(u.length),l=i(s,c);if(e&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(13);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e){e.exports={name:"jso",version:"4.1.1",description:"OAuth 2.0 implementation in Javascript",main:"dist/jso.js",module:"src/JSO.js",scripts:{test:"true",preversion:"npm test",version:"npm run build && git add -A dist",postversion:"git push && git push --tags && npm publish",build:"webpack --mode production --config webpack.config.js"},babel:{presets:["env"]},repository:{type:"git",url:"https://github.com/andreassolberg/jso.git"},keywords:["oauth","authentication","authorization","rest","api","ajax","jquery"],files:["src"],eslintConfig:{env:{es6:!0,browser:!0,node:!1}},devDependencies:{"babel-core":"^6.26.0","babel-loader":"^7.1.4","babel-preset-env":"^1.6.1","babel-preset-react":"^6.24.1",qunit:"^2.5.1",webpack:"^4.1.1","webpack-cli":"^2.0.12"},author:"Andreas \xc5kre Solberg",license:"LGPL-2.1",bugs:{url:"https://github.com/andreassolberg/jso/issues"},homepage:"https://github.com/andreassolberg/jso",dependencies:{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"on",value:function(e,t){this._callbacks||(this._callbacks={}),this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t)}},{key:"emit",value:function(e){this._callbacks||(this._callbacks={}),this._callbacks[e]||(this._callbacks[e]=[]);for(var t=Array.prototype.slice.call(arguments,1),r=0;r<this._callbacks[e].length;r++)this._callbacks[e][r].apply(this,t)}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={};for(var t=0;t<arguments.length;t++)Object.assign(this.config,arguments[t])}return n(e,[{key:"has",value:function(e){var t=this.config,r=e.split("."),n=0;for(n=0;n<r.length;n++){if(!t.hasOwnProperty(r[n]))return!1;t=t[r[n]]}return!0}},{key:"getValue",value:function(e,t,r){r=r||!1;var n=this.config,o=e.split("."),i=0;for(i=0;i<o.length;i++){if(!n.hasOwnProperty(o[i])){n=void 0;break}n=n[o[i]]}if(void 0===n){if(r)throw new Error("Configuration option ["+o[i]+"] required but not provided.");return t}return n}}]),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(n=r(28))&&n.__esModule?n:{default:n},s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"toString",value:function(){return"OAuthResponseError: ["+(this.error||"unknown")+"]: "+(this.error_description||"unknown")}}]),t}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(n=r(29))&&n.__esModule?n:{default:n},s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jso=t,this.jquery=r}return o(e,[{key:"_fetch",value:function(e,t){var r=this;return new Promise(function(n,o){return t.done=n,t.fail=function(e,t,n){return 401===parseInt(t,10)?(r.jso.wipeTokens(),o(new i.default)):o(n)},r.jquery.ajax(e,t)})}},{key:"fetch",value:function(e,t,r){var n=this;if((r=r||0)>2)throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var o={},s={mode:"cors"};return t&&(s=t,Object.assign(s,t)),t&&t.jso&&Object.assign(o,t.jso),this.jso.getToken(o).catch(function(e){console.error("Error fetching token to use ",e)}).then(function(o){return s.headers||(s.headers={}),s.headers.Authorization="Bearer "+o.access_token,n._fetch(e,s).catch(function(o){if(o instanceof i.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",o),n.jso.wipeTokens(),n.fetch(e,t,r+1)})})}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(n=r(29))&&n.__esModule?n:{default:n},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jso=t}return o(e,[{key:"_fetch",value:function(e,t){return fetch(e,t).then(function(e){if(401===e.status)throw new i.default;return e})}},{key:"fetch",value:function(e,t,r){var n=this;if((r=r||0)>2)throw new Error("Reccursion error. Expired tokens deleted and tried again multiple times.");var o={},s={mode:"cors"};return t&&(s=t,Object.assign(s,t)),t&&t.jso&&Object.assign(o,t.jso),this.jso.getToken(o).catch(function(e){console.error("Error fetching token to use ",e)}).then(function(o){return s.headers||(s.headers={}),s.headers.Authorization="Bearer "+o.access_token,n._fetch(e,s).catch(function(o){if(o instanceof i.default)return console.error("Token was expired. Deleting all tokens for this provider and get a new one",o),n.jso.wipeTokens(),n.fetch(e,t,r+1)})})}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(n=r(11))&&n.__esModule?n:{default:n},s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,r){window.popupCompleted=function(){var e=n.location.href;t(e)};var n=window.open(e.url,"jso-popup-auth","height=600,width=800");if(null===n)throw new Error("Error loading popup window");window.focus&&n.focus()})}}]),t}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=s(r(11)),i=s(r(12));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.timeout=5e3,r.callback=null,r.isCompleted=!1,r.id="jso_passive_iframe_"+i.default.uuid();var n=window.addEventListener?"addEventListener":"attachEvent";return window[n],r.iframe=document.createElement("iframe"),r.iframe.setAttribute("id",r.id),r.iframe.setAttribute("src",e),r.iframe.addEventListener("load",function(e){var t=null;try{if(r.iframe.contentWindow.location.hash){var n=r.iframe.contentWindow.location.hash.substring(1);t=i.default.parseQueryString(n)}else if(r.iframe.contentWindow.location.search){var o=r.iframe.contentWindow.location.search.substring(1);t=i.default.parseQueryString(o)}null!==t?r._completed(t):r._failed(new Error("Failed to obtain response value from iframe"))}catch(e){}}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,r){e.callback=t,e.errorCallback=r,document.getElementsByTagName("body")[0].appendChild(e.iframe),setTimeout(function(){e._failed(new Error("Loading iframe timed out"))},e.timeout)})}},{key:"_cleanup",value:function(){var e=document.getElementById(this.id);e.parentNode.removeChild(e)}},{key:"_failed",value:function(e){this.isCompleted||(this.errorCallback&&"function"==typeof this.errorCallback&&this.errorCallback(e),this.isCompleted=!0,this._cleanup())}},{key:"_completed",value:function(e){this.isCompleted||(this.callback&&"function"==typeof this.callback&&this.callback(e),this.isCompleted=!0,this._cleanup())}}]),t}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=i(r(11));function i(e){return e&&e.__esModule?e:{default:e}}i(r(12));var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),n(t,[{key:"execute",value:function(){var e=this;return new Promise(function(t,r){window.location=e.url})}}]),t}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(n=r(12))&&n.__esModule?n:{default:n},s=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"saveState",value:function(e,t){localStorage.setItem("state-"+e,JSON.stringify(t))}},{key:"getState",value:function(e){var t=JSON.parse(localStorage.getItem("state-"+e));return localStorage.removeItem("state-"+e),t}},{key:"hasScope",value:function(e,t){var r;if(!e.scopes)return!1;for(r=0;r<e.scopes.length;r++)if(e.scopes[r]===t)return!0;return!1}},{key:"filterTokens",value:function(e,t){var r,n,o,s=[],a=i.default.epoch();for(t||(t=[]),r=0;r<e.length;r++){for(o=!0,e[r].expires&&e[r].expires<a+1&&(o=!1),n=0;n<t.length;n++)this.hasScope(e[r],t[n])||(o=!1);o&&s.push(e[r])}return s}},{key:"saveTokens",value:function(e,t){localStorage.setItem("tokens-"+e,JSON.stringify(t))}},{key:"getTokens",value:function(e){var t=JSON.parse(localStorage.getItem("tokens-"+e));return t||(t=[]),i.default.log("Token found when loooking up provider "+e+" in store "+window.location.href,t),t}},{key:"wipeTokens",value:function(e){localStorage.removeItem("tokens-"+e)}},{key:"saveToken",value:function(e,t){var r=this.getTokens(e);(r=this.filterTokens(r)).push(t),this.saveTokens(e,r)}},{key:"getToken",value:function(e,t){var r=this.getTokens(e);return(r=this.filterTokens(r,t)).length<1?null:r[0]}}]),e}());t.default=s},function(e,t,r){"use strict";var n=r(5),o=r(17),i=r(31);n(n.S,"Promise",{try:function(e){var t=o.f(this),r=i(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){"use strict";var n=r(5),o=r(2),i=r(1),s=r(33),a=r(30);n(n.P+n.R,"Promise",{finally:function(e){var t=s(this,o.Promise||i.Promise),r="function"==typeof e;return this.then(r?function(r){return a(t,e()).then(function(){return r})}:e,r?function(r){return a(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){var n=r(0)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i=[7],s=i[n]();s.next=function(){return{done:r=!0}},i[n]=function(){return s},e(i)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(1),o=r(16),i=r(9),s=r(0)("species");e.exports=function(e){var t=n[e];i&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(8);e.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},function(e,t,r){var n=r(1),o=r(32).set,i=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,u="process"==r(13)(s);e.exports=function(){var e,t,r,c=function(){var n,o;for(u&&(n=s.domain)&&n.exit();e;){o=e.fn,e=e.next;try{o()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(u)r=function(){s.nextTick(c)};else if(!i||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var l=a.resolve();r=function(){l.then(c)}}else r=function(){o.call(n,c)};else{var f=!0,h=document.createTextNode("");new i(c).observe(h,{characterData:!0}),r=function(){h.data=f=!f}}return function(n){var o={fn:n,next:void 0};t&&(t.next=o),e||(e=o,r()),t=o}}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(19),o=r(0)("iterator"),i=r(6);e.exports=r(2).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var n=r(6),o=r(0)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||i[o]===e)}},function(e,t,r){var n=r(3);e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){var i=e.return;throw void 0!==i&&n(i.call(e)),t}}},function(e,t,r){var n=r(15),o=r(64),i=r(63),s=r(3),a=r(41),u=r(62),c={},l={};(t=e.exports=function(e,t,r,f,h){var p,g,d,v,y=h?function(){return e}:u(e),b=n(r,f,t?2:1),w=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(i(y)){for(p=a(e.length);p>w;w++)if((v=t?b(s(g=e[w])[0],g[1]):b(e[w]))===c||v===l)return v}else for(d=y.call(e);!(g=d.next()).done;)if((v=o(d,b,g.value,t))===c||v===l)return v}).BREAK=c,t.RETURN=l},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){"use strict";var n,o,i,s,a=r(35),u=r(1),c=r(15),l=r(19),f=r(5),h=r(10),p=r(14),g=r(66),d=r(65),v=r(33),y=r(32).set,b=r(60)(),w=r(17),m=r(31),_=r(30),T=u.TypeError,S=u.process,k=u.Promise,E="process"==l(S),P=function(){},L=o=w.f,C=!!function(){try{var e=k.resolve(1),t=(e.constructor={})[r(0)("species")]=function(e){e(P,P)};return(E||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t}catch(e){}}(),O=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},x=function(e,t){if(!e._n){e._n=!0;var r=e._c;b(function(){for(var n=e._v,o=1==e._s,i=0,s=function(t){var r,i,s=o?t.ok:t.fail,a=t.resolve,u=t.reject,c=t.domain;try{s?(o||(2==e._h&&j(e),e._h=1),!0===s?r=n:(c&&c.enter(),r=s(n),c&&c.exit()),r===t.promise?u(T("Promise-chain cycle")):(i=O(r))?i.call(r,a,u):a(r)):u(n)}catch(e){u(e)}};r.length>i;)s(r[i++]);e._c=[],e._n=!1,t&&!e._h&&I(e)})}},I=function(e){y.call(u,function(){var t,r,n,o=e._v,i=A(e);if(i&&(t=m(function(){E?S.emit("unhandledRejection",o,e):(r=u.onunhandledrejection)?r({promise:e,reason:o}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",o)}),e._h=E||A(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},A=function(e){return 1!==e._h&&0===(e._a||e._c).length},j=function(e){y.call(u,function(){var t;E?S.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},R=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),x(t,!0))},M=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=O(e))?b(function(){var n={_w:r,_d:!1};try{t.call(e,c(M,n,1),c(R,n,1))}catch(e){R.call(n,e)}}):(r._v=e,r._s=1,x(r,!1))}catch(e){R.call({_w:r,_d:!1},e)}}};C||(k=function(e){g(this,k,"Promise","_h"),p(e),n.call(this);try{e(c(M,this,1),c(R,this,1))}catch(e){R.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(59)(k.prototype,{then:function(e,t){var r=L(v(this,k));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=E?S.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&x(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new n;this.promise=e,this.resolve=c(M,e,1),this.reject=c(R,e,1)},w.f=L=function(e){return e===k||e===s?new i(e):o(e)}),f(f.G+f.W+f.F*!C,{Promise:k}),r(18)(k,"Promise"),r(58)("Promise"),s=r(2).Promise,f(f.S+f.F*!C,"Promise",{reject:function(e){var t=L(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(a||!C),"Promise",{resolve:function(e){return _(a&&this===s?k:this,e)}}),f(f.S+f.F*!(C&&r(57)(function(e){k.all(e).catch(P)})),"Promise",{all:function(e){var t=this,r=L(t),n=r.resolve,o=r.reject,i=m(function(){var r=[],i=0,s=1;d(e,!1,function(e){var a=i++,u=!1;r.push(void 0),s++,t.resolve(e).then(function(e){u||(u=!0,r[a]=e,--s||n(r))},o)}),--s||n(r)});return i.e&&o(i.v),r.promise},race:function(e){var t=this,r=L(t),n=r.reject,o=m(function(){d(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return o.e&&n(o.v),r.promise}})},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(37),o=r(68),i=r(6),s=r(23);e.exports=r(36)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(e,t,r){for(var n=r(69),o=r(24),i=r(8),s=r(1),a=r(4),u=r(6),c=r(0),l=c("iterator"),f=c("toStringTag"),h=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=o(p),d=0;d<g.length;d++){var v,y=g[d],b=p[y],w=s[y],m=w&&w.prototype;if(m&&(m[l]||a(m,l,h),m[f]||a(m,f,y),u[y]=h,b))for(v in n)m[v]||i(m,v,n[v],!0)}},function(e,t,r){var n=r(7),o=r(38),i=r(20)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),n(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,r){var n=r(16),o=r(3),i=r(24);e.exports=r(9)?Object.defineProperties:function(e,t){o(e);for(var r,s=i(t),a=s.length,u=0;a>u;)n.f(e,r=s[u++],t[r]);return e}},function(e,t,r){var n=r(3),o=r(72),i=r(39),s=r(20)("IE_PROTO"),a=function(){},u=function(){var e,t=r(26)("iframe"),n=i.length;for(t.style.display="none",r(34).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;n--;)delete u.prototype[i[n]];return u()};e.exports=Object.create||function(e,t){var r;return null!==e?(a.prototype=n(e),r=new a,a.prototype=null,r[s]=e):r=u(),void 0===t?r:o(r,t)}},function(e,t,r){"use strict";var n=r(73),o=r(44),i=r(18),s={};r(4)(s,r(0)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(s,{next:o(1,r)}),i(e,t+" Iterator")}},function(e,t,r){var n=r(21),o=r(22);e.exports=function(e){return function(t,r){var i,s,a=String(o(t)),u=n(r),c=a.length;return u<0||u>=c?e?"":void 0:(i=a.charCodeAt(u))<55296||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):i:e?a.slice(u,u+2):s-56320+(i-55296<<10)+65536}}},function(e,t,r){"use strict";var n=r(75)(!0);r(36)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){"use strict";var n=r(19),o={};o[r(0)("toStringTag")]="z",o+""!="[object z]"&&r(8)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(e,t,r){r(77),r(76),r(70),r(67),r(56),r(55),e.exports=r(2).Promise},function(e,t,r){"use strict";var n=r(5),o=r(42)(!0);n(n.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),r(37)("includes")},function(e,t,r){r(79),e.exports=r(2).Array.includes},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(21),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},function(e,t,r){var n=r(7),o=r(23),i=r(42)(!1),s=r(20)("IE_PROTO");e.exports=function(e,t){var r,a=o(e),u=0,c=[];for(r in a)r!=s&&n(a,r)&&c.push(r);for(;t.length>u;)n(a,r=t[u++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){"use strict";var n=r(24),o=r(82),i=r(81),s=r(38),a=r(43),u=Object.assign;e.exports=!u||r(27)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=u({},e)[r]||Object.keys(u({},t)).join("")!=n})?function(e,t){for(var r=s(e),u=arguments.length,c=1,l=o.f,f=i.f;u>c;)for(var h,p=a(arguments[c++]),g=l?n(p).concat(l(p)):n(p),d=g.length,v=0;d>v;)f.call(p,h=g[v++])&&(r[h]=p[h]);return r}:u},function(e,t,r){var n=r(10);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=!r(9)&&!r(27)(function(){return 7!=Object.defineProperty(r(26)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(5);n(n.S+n.F,"Object",{assign:r(85)})},function(e,t,r){r(88),e.exports=r(2).Object.assign},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetcherJQuery=t.Fetcher=t.IFramePassive=t.Popup=t.HTTPRedirect=t.BasicLoader=t.JSO=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=y(r(89));r(80),r(78);var s=y(r(54)),a=y(r(12)),u=y(r(11)),c=y(r(53)),l=y(r(52)),f=y(r(51)),h=y(r(50)),p=y(r(49)),g=y(r(48)),d=y(r(47)),v=y(r(46));function y(e){return e&&e.__esModule?e:{default:e}}r(45);var b={lifetime:3600},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.configure(e),r.providerID=r.getProviderID(),r.Loader=c.default,r.store=s.default,r.callbacks={},r.config.getValue("debug",!1)&&(a.default.debug=!0),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.default),o(t,[{key:"configure",value:function(e){this.config=new d.default(b,e)}},{key:"setStore",value:function(e){this.store=e}},{key:"setLoader",value:function(e){if("function"!=typeof e)throw new Error("loader MUST be an instance of the JSO BasicLoader");this.Loader=e}},{key:"getProviderID",value:function(){var e=this.config.getValue("providerID",null);if(null!==e)return e;var t=this.config.getValue("client_id",null,!0);return this.config.getValue("authorization",null,!0)+"|"+t}},{key:"processTokenResponse",value:function(e){var t;if(!e.state)throw new Error("Could not get state from storage.");if(!(t=this.store.getState(e.state)))throw new Error("Could not retrieve state");if(!t.providerID)throw new Error("Could not get providerid from state");return a.default.log("processTokenResponse ",e,""),this.processReceivedToken(e,t)}},{key:"processReceivedToken",value:function(e,t){var r=a.default.epoch();return e.received=r,e.expires_in?(e.expires=r+parseInt(e.expires_in,10),e.expires_in=parseInt(e.expires_in,10)):!1===this.config.getValue("default_lifetime",null)?e.expires=null:this.config.has("permanent_scope")?this.store.hasScope(e,this.config.getValue("permanent_scope"))||(e.expires=null):this.config.has("default_lifetime")?e.expires=r+this.config.getValue("default_lifetime"):e.expires=r+3600,e.scope?(e.scopes=e.scope.split(" "),delete e.scope):t.scopes?e.scopes=t.scopes:e.scopes=[],a.default.log("processTokenResponse completed ",e,""),this.store.saveToken(t.providerID,e),t.restoreHash?window.location.hash=t.restoreHash:window.location.hash="",e}},{key:"processAuthorizationCodeResponse",value:function(e){var t=this;console.log(this),this.emit("authorizationCode",e);var r=void 0;if(!e.state)throw new Error("Could not find state paramter from callback.");if(null===(r=this.store.getState(e.state)))throw new Error("Could not find retrieve state object.");if(console.log("state",r),this.config.has("token")){if(!this.config.has("client_secret"))throw new Error("Configuration missing [client_secret]");var n=new Headers;n.append("Authorization","Basic "+btoa(this.config.getValue("client_id")+":"+this.config.getValue("client_secret"))),n.append("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");var o={grant_type:"authorization_code",code:e.code};r.hasOwnProperty("redirect_uri")&&(o.redirect_uri=r.redirect_uri);var i={mode:"cors",headers:n,method:"POST",body:a.default.encodeQS(o)};return fetch(this.config.getValue("token"),i).then(function(e){return e.json()}).then(function(e){return a.default.log("Received response on token endpoint ",e,""),t.processReceivedToken(e,r)})}a.default.log("Received an authorization code. Will not process it as the config option [token] endpoint is not set. If you would like to process the code yourself, please subscribe to the [authorizationCode] event")}},{key:"processErrorResponse",value:function(e){var t;if(!e.state)throw new Error("Could not get [state] and no default providerid is provided.");if(!(t=this.store.getState(e.state)))throw new Error("Could not retrieve state");if(!t.providerID)throw new Error("Could not get providerid from state");return t.restoreHash?window.location.hash=t.restoreHash:window.location.hash="",new g.default(e)}},{key:"callback",value:function(e){var t=null;if("object"===(void 0===e?"undefined":n(e)))t=e;else if("string"==typeof e)t=a.default.getResponseFromURL(e);else{if(void 0!==e)return;t=a.default.getResponseFromURL(window.location.href)}if(a.default.log("Receving response in callback",t),t.hasOwnProperty("access_token"))return this.processTokenResponse(t);if(t.hasOwnProperty("code"))return this.processAuthorizationCodeResponse(t);if(t.hasOwnProperty("error"))throw this.processErrorResponse(t)}},{key:"dump",value:function(){var e=this.store.getTokens(this.providerID);return{providerID:this.providerID,tokens:e,config:this.config}}},{key:"_getRequestScopes",value:function(e){var t,r=[];if(this.config.has("scopes.request")){var n=this.config.getValue("scopes.request");for(t=0;t<n.length;t++)r.push(n[t])}if(e&&e.scopes&&e.scopes.request)for(t=0;t<e.scopes.request.length;t++)r.push(e.scopes.request[t]);return a.default.uniqueList(r)}},{key:"_getRequiredScopes",value:function(e){var t,r=[];if(this.config.has("scopes.require")){var n=this.config.getValue("scopes.require");for(t=0;t<n.length;t++)r.push(n[t])}if(e&&e.scopes&&e.scopes.require)for(t=0;t<e.scopes.require.length;t++)r.push(e.scopes.require[t]);return a.default.uniqueList(r)}},{key:"getToken",value:function(e){var t=this;return e=e||{},new Promise(function(r,n){var o=t._getRequiredScopes(e),i=t.store.getToken(t.providerID,o);if(i)return r(i);if(e.hasOwnProperty("allowredir")&&!e.allowredir)throw new Error("Cannot obtain a token, when not allowed to redirect...");r(t._authorize(e))})}},{key:"checkToken",value:function(e){var t=this._getRequiredScopes(e);return this.store.getToken(this.providerID,t)}},{key:"_authorize",value:function(e){var t,r,n,o=this;return Promise.resolve().then(function(){var s,u=o.config.getValue("authorization",null,!0),c=o.config.getValue("client_id",null,!0);if(e.hasOwnProperty("allowia")||o.config.has("allowia"))throw new Error('The allowia option was removed in JSO 4.1.0. Instead use {request: {prompt: "none"}}');if(a.default.log("About to send an authorization request to this endpoint",u),a.default.log("Options",e),t={},o.config.has("request")){var l=o.config.getValue("request");t=(0,i.default)(t,l)}if(e.hasOwnProperty("request")&&(t=(0,i.default)(t,e.request)),t.response_type=e.response_type||o.config.getValue("response_type","id_token token"),t.state=a.default.uuid(),o.config.has("redirect_uri")&&(t.redirect_uri=o.config.getValue("redirect_uri","")),e.redirect_uri&&(t.redirect_uri=e.redirect_uri),t.client_id=c,s=(n=o._getRequestScopes(e)).includes("openid"),n.length>0&&(t.scope=a.default.scopeList(n)),a.default.log("Running in mode: "+(s?"OpenID Connect mode":"OAuth mode")),s&&!t.hasOwnProperty("redirect_uri"))throw new Error("An OpenID Request requires a redirect_uri to be set. Please add to configuration. A redirect_uri is not required for plain OAuth");s&&(t.nonce=a.default.uuid()),a.default.log("Debug Authentication request object",JSON.stringify(t,void 0,2)),r=a.default.encodeURL(u,t),window.location.hash&&(t.restoreHash=window.location.hash),t.providerID=o.providerID,n&&(t.scopes=n),a.default.log("Saving state ["+t.state+"]"),a.default.log(JSON.parse(JSON.stringify(t)));var f=o.Loader;return e.hasOwnProperty("loader")&&(f=e.loader),a.default.log("Looking for loader",e,f),o.store.saveState(t.state,t),o.gotoAuthorizeURL(r,f).then(function(e){if(!0!==e)return o.callback(e)})})}},{key:"gotoAuthorizeURL",value:function(e,t){return new Promise(function(r,n){if(null!==t&&"function"==typeof t){var o=new t(e);if(!(o instanceof u.default))throw new Error("JSO selected Loader is not an instance of BasicLoader.");r(o.execute())}else n(new Error("Cannot redirect to authorization endpoint because of missing redirect handler"))})}},{key:"wipeTokens",value:function(){this.store.wipeTokens(this.providerID)}}]),t}();t.JSO=w,t.BasicLoader=u.default,t.HTTPRedirect=c.default,t.Popup=f.default,t.IFramePassive=l.default,t.Fetcher=h.default,t.FetcherJQuery=p.default}])})},{}],MainGameManager:[function(e,t,r){"use strict";cc._RF.push(t,"19a893QP+5CGqpSjj3a3VTk","MainGameManager"),Object.defineProperty(r,"__esModule",{value:!0});var n=e("@aspnet/signalr"),o=e("jso"),i=cc._decorator,s=i.ccclass,a=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var r;return __extends(t,e),r=t,t.prototype.start=function(){var e=this;this.authenticate().then(function(t){e.connect()}).catch(function(e){cc.error("Error authenticating: "+e)})},t.prototype.authenticate=function(){var e=this,t=new o.JSO({providerID:"snapGameOauth",client_id:"snapGameApiDevSwagger",authorization:"https://localhost:52365/connect/authorize",redirect_uri:"https://localhost:5001",token:"https://localhost:52365/connect/token",debug:!0,scopes:{request:["snapgame"]},response_type:"token",request:{nonce:"636864884858396406.MWI4ZjNkYWItOGU1My00YmFiLTg1MTAtMWQzOTY2OTM4YzRkOGFhOGI1OGItODc0YS00NGEyLWI3NzgtYzU0YmJiMzk5NWY0"}});t.callback();return t.getToken().then(function(t){return cc.log("I got the token: ",t),e.token=t}).catch(function(e){cc.error("Error from getToken",e)})},t.prototype.connect=function(){var e=this;if(this.connection)this.reconnect();else{var t=(new n.HubConnectionBuilder).configureLogging(n.LogLevel.Information).withUrl(r.ENPOINT,{accessTokenFactory:function(){return e.token.access_token}});this.connection=t.build(),this.reconnect().then(function(){e.connection.on(r.POP_CARD_MESSAGE,function(e){cc.log("Card Pop Message received: "+e)})})}},t.prototype.popCard=function(){if(this.connection.state!==n.HubConnectionState.Disconnected){this.connection.invoke(r.POP_CARD_MESSAGE,1).then(function(e){cc.log("Message sent. Result: "+e)}).catch(function(e){return cc.error(e+".toString()")})}else cc.log("Not connected")},t.prototype.reconnect=function(){if(this.connection)return cc.log("Connecting"),this.connection.start().then(function(){return cc.log("Connection stablish!")}).catch(function(e){cc.error("Error connecting. "+e)});cc.error("The connection hasn't been configured yet")},t.JOIN_GAME_MESSAGE="JoinGame",t.START_GAME_MESSAGE="StartGame",t.POP_CARD_MESSAGE="PopCard",t.ENPOINT="https://localhost:44378/game_notifications",t=r=__decorate([s],t)}(cc.Component));r.default=a,cc._RF.pop()},{"@aspnet/signalr":24,jso:25}]},{},["MainGameManager"]);